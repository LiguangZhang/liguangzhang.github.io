<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=LXGW WenKai:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"liguangzhang.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":{"gitalk":{"order":-2}},"activeClass":"gitalk"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":true},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

  <meta name="description" content="AB调试笔记基于androidP base. 相关文档官方文档AB官方文档 在启用了 A&#x2F;B 的设备上，可以在后台对应用进行编译，以更新到新的系统映像。如需在系统映像中选择性地加入编译脚本和二进制文件，请参阅在后台编译应用。 preopt相关 AB 系统更新概括 AB配置https:&#x2F;&#x2F;source.android.com&#x2F;devices&#x2F;tech&#x2F;ota&#x2F;ab_implement.ht">
<meta property="og:type" content="article">
<meta property="og:title" content="AB调试笔记">
<meta property="og:url" content="https://liguangzhang.github.io/2019/11/12/OTA%E7%9B%B8%E5%85%B3/AB%E8%B0%83%E8%AF%95%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="blog">
<meta property="og:description" content="AB调试笔记基于androidP base. 相关文档官方文档AB官方文档 在启用了 A&#x2F;B 的设备上，可以在后台对应用进行编译，以更新到新的系统映像。如需在系统映像中选择性地加入编译脚本和二进制文件，请参阅在后台编译应用。 preopt相关 AB 系统更新概括 AB配置https:&#x2F;&#x2F;source.android.com&#x2F;devices&#x2F;tech&#x2F;ota&#x2F;ab_implement.ht">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-11-12T10:15:54.000Z">
<meta property="article:modified_time" content="2024-04-16T08:41:13.424Z">
<meta property="article:author" content="liguang.zhang">
<meta property="article:tag" content="Android">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://liguangzhang.github.io/2019/11/12/OTA%E7%9B%B8%E5%85%B3/AB%E8%B0%83%E8%AF%95%E7%AC%94%E8%AE%B0/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>
<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont/style.css" media="print" onload="this.media='all'" />

  <title>AB调试笔记 | blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://liguangzhang.github.io/2019/11/12/OTA%E7%9B%B8%E5%85%B3/AB%E8%B0%83%E8%AF%95%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liguang.zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          AB调试笔记
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-12 18:15:54" itemprop="dateCreated datePublished" datetime="2019-11-12T18:15:54+08:00">2019-11-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-04-16 16:41:13" itemprop="dateModified" datetime="2024-04-16T16:41:13+08:00">2024-04-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index"><span itemprop="name">Android</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/OTA/" itemprop="url" rel="index"><span itemprop="name">OTA</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="AB调试笔记"><a href="#AB调试笔记" class="headerlink" title="AB调试笔记"></a>AB调试笔记</h1><p>基于androidP base.</p>
<h2 id="相关文档"><a href="#相关文档" class="headerlink" title="相关文档"></a>相关文档</h2><h3 id="官方文档"><a href="#官方文档" class="headerlink" title="官方文档"></a>官方文档</h3><p><a target="_blank" rel="noopener" href="https://source.android.com/devices/tech/ota/ab">AB官方文档</a></p>
<p>在启用了 A&#x2F;B 的设备上，可以在后台对应用进行编译，以更新到新的系统映像。如需在系统映像中选择性地加入编译脚本和二进制文件，请参阅在后台编译应用。</p>
<p><a target="_blank" rel="noopener" href="https://source.android.com/devices/tech/dalvik/configure.html#other_odex">preopt相关</a></p>
<p><a target="_blank" rel="noopener" href="https://source.android.com/devices/tech/ota/ab_updates.html#compilation">AB 系统更新概括</a></p>
<p><a target="_blank" rel="noopener" href="https://source.android.com/devices/tech/ota/ab_implement.html">AB配置</a><a target="_blank" rel="noopener" href="https://source.android.com/devices/tech/ota/ab_implement.html">https://source.android.com/devices/tech/ota/ab_implement.html</a>)</p>
<h3 id="第三方文档"><a href="#第三方文档" class="headerlink" title="第三方文档"></a>第三方文档</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/guyongqiangx/article/details/71334889">Android A&#x2F;B System OTA分析（一）概览</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/guyongqiangx/article/details/71516768">Android A&#x2F;B System OTA分析（二）系统image的生成</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/guyongqiangx/article/details/72480154">Android A&#x2F;B System OTA分析（三）主系统和bootloader的通信</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/guyongqiangx/article/details/72604355">Android A&#x2F;B System OTA分析（四）系统的启动和升级</a></p>
<p>启用IBootControl服务(hidl相关配置)相关文档</p>
<p><a target="_blank" rel="noopener" href="http://hooltech.com/android-hidl.html#%E7%AE%80%E4%BB%8B">hidl配置简介</a><a target="_blank" rel="noopener" href="https://blog.csdn.net/guyongqiangx/article/details/72604355">https://blog.csdn.net/guyongqiangx/article/details/72604355</a>)</p>
<h3 id="之前的项目文档"><a href="#之前的项目文档" class="headerlink" title="之前的项目文档"></a>之前的项目文档</h3><p><a target="_blank" rel="noopener" href="https://wiki.n.miui.com/pages/viewpage.action?pageId=33933409">A&#x2F;B系统升级功能点</a></p>
<p><a target="_blank" rel="noopener" href="https://wiki.n.miui.com/pages/viewpage.action?pageId=33930350">A&#x2F;B 系统升级（双分区系统升级）</a></p>
<p><a target="_blank" rel="noopener" href="https://wiki.n.miui.com/pages/viewpage.action?pageId=34968890">Android One A&#x2F;B OTA Updater</a></p>
<h2 id="配置相关"><a href="#配置相关" class="headerlink" title="配置相关"></a>配置相关</h2><h3 id="设置编译变量"><a href="#设置编译变量" class="headerlink" title="设置编译变量"></a>设置编译变量</h3><p>支持 A&#x2F;B 更新的引导加载程序必须满足以下编译变量条件:</p>
<h4 id="必须针对-A-B-更新目标定义的变量"><a href="#必须针对-A-B-更新目标定义的变量" class="headerlink" title="必须针对 A&#x2F;B 更新目标定义的变量"></a>必须针对 A&#x2F;B 更新目标定义的变量</h4><ul>
<li>AB_OTA_UPDATER :&#x3D; true</li>
<li>AB_OTA_PARTITIONS :&#x3D; <br>boot <br>system <br>vendor</li>
<li>以及通过 update_engine 更新的其他分区（无线装置、引导加载程序等）。</li>
<li>BOARD_BUILD_SYSTEM_ROOT_IMAGE :&#x3D; true</li>
<li>TARGET_NO_RECOVERY :&#x3D; true</li>
<li>BOARD_USES_RECOVERY_AS_BOOT :&#x3D; true</li>
<li>PRODUCT_PACKAGES +&#x3D; <br>update_engine <br>update_verifier</li>
<li>要查看示例，请参阅 &#x2F;device&#x2F;google&#x2F;marlin&#x2F;+&#x2F;android-7.1.0_r1&#x2F;device-common.mk。 您可以选择执行编译中所述的安装后（但在重新启动前）dex2oat 步骤.</li>
</ul>
<h4 id="无法针对-A-B-目标定义的变量"><a href="#无法针对-A-B-目标定义的变量" class="headerlink" title="无法针对 A&#x2F;B 目标定义的变量:"></a>无法针对 A&#x2F;B 目标定义的变量:</h4><ul>
<li>BOARD_RECOVERYIMAGE_PARTITION_SIZE</li>
<li>BOARD_CACHEIMAGE_PARTITION_SIZE</li>
<li>BOARD_CACHEIMAGE_FILE_SYSTEM_TYPE</li>
</ul>
<h4 id="可选-针对调试版本定义的变量"><a href="#可选-针对调试版本定义的变量" class="headerlink" title="可选 针对调试版本定义的变量"></a>可选 针对调试版本定义的变量</h4><p>PRODUCT_PACKAGES_DEBUG +&#x3D; update_engine_client</p>
<h3 id="节选-非GMS版本需要客户端"><a href="#节选-非GMS版本需要客户端" class="headerlink" title="(节选) 非GMS版本需要客户端"></a>(节选) 非GMS版本需要客户端</h3><ul>
<li>GmsCore 起到什么作用？<br>在 Google 的 A&#x2F;B 实现中，平台 API 和 update_engine 负责提供机制，而 GmsCore 则负责提供政策。也就是说，平台知道如何应用 A&#x2F;B 更新，并且所有相应代码都位于 AOSP 中（如上所述），而 GmsCore 则负责确定应用哪些内容以及何时应用。<br>如果不使用 GmsCore，则可以使用<code>相同的平台 API</code> 编写自己的替代项。用于<code>控制 update_engine 的平台</code>.  Java API 是 android.os.UpdateEngine：<code>frameworks/base/core/java/android/os/UpdateEngine.java</code>。调用程序可以提供 <code>UpdateEngineCallback</code>，以便接收有关状态更新的通知：<code>frameworks/base/+/master/core/java/android/os/UpdateEngineCallback.java</code>。请参阅核心类的参考文件，了解如何使用相应接口。</li>
</ul>
<h2 id="空间对比"><a href="#空间对比" class="headerlink" title="空间对比"></a>空间对比</h2><table>
<thead>
<tr>
<th>abl_b</th>
<th>2048</th>
</tr>
</thead>
<tbody><tr>
<td>aop_b</td>
<td>512</td>
</tr>
<tr>
<td>bluetooth_b</td>
<td>1024</td>
</tr>
<tr>
<td>boot_b</td>
<td>131072</td>
</tr>
<tr>
<td>cmnlib64_b</td>
<td>1024</td>
</tr>
<tr>
<td>cmnlib_b</td>
<td>1024</td>
</tr>
<tr>
<td>devcfg_b</td>
<td>256</td>
</tr>
<tr>
<td>dsp_b</td>
<td>65536</td>
</tr>
<tr>
<td>dtbo_b</td>
<td>32768</td>
</tr>
<tr>
<td>hyp_b</td>
<td>8192</td>
</tr>
<tr>
<td>ifaa_b</td>
<td>65536</td>
</tr>
<tr>
<td>imagefv_b</td>
<td>2048</td>
</tr>
<tr>
<td>keymaster_b</td>
<td>1024</td>
</tr>
<tr>
<td>modem_b</td>
<td>327680</td>
</tr>
<tr>
<td>multiimgoem_b</td>
<td>32</td>
</tr>
<tr>
<td>qupfw_b</td>
<td>128</td>
</tr>
<tr>
<td>system_b</td>
<td>3670016</td>
</tr>
<tr>
<td>tz_b</td>
<td>4096</td>
</tr>
<tr>
<td>uefisecapp_b</td>
<td>2048</td>
</tr>
<tr>
<td>vbmeta_b</td>
<td>128</td>
</tr>
<tr>
<td>vendor_b</td>
<td>2097152</td>
</tr>
<tr>
<td>xbl_b</td>
<td>7168</td>
</tr>
<tr>
<td>xbl_config_b</td>
<td>512</td>
</tr>
<tr>
<td>total</td>
<td>6270.53125</td>
</tr>
</tbody></table>
<h2 id="升级包相关"><a href="#升级包相关" class="headerlink" title="升级包相关"></a>升级包相关</h2><p>升级包结构</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">├── care_map.txt</span><br><span class="line">├── compatibility.zip</span><br><span class="line">├── META-INF</span><br><span class="line">│   ├── CERT.RSA</span><br><span class="line">│   ├── CERT.SF</span><br><span class="line">│   ├── com</span><br><span class="line">│   │   └── android</span><br><span class="line">│   │       ├── metadata</span><br><span class="line">│   │       └── otacert</span><br><span class="line">│   └── MANIFEST.MF</span><br><span class="line">├── payload.bin</span><br><span class="line">└── payload_properties.txt</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>主要文件全在payload.bin中, 没有升级脚本</p>
<p>metadata文件:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ota-property-files=payload_metadata.bin:9649:149799,payload.bin:9649:1153246262,payload_properties.txt:1153255969:156,care_map.txt:752:239,compatibility.zip:1044:8558,metadata:69:635</span><br><span class="line">ota-required-cache=0</span><br><span class="line">ota-streaming-property-files=payload.bin:9649:1153246262,payload_properties.txt:1153255969:156,care_map.txt:752:239,compatibility.zip:1044:8558,metadata:69:635</span><br><span class="line">ota-type=AB</span><br><span class="line">post-build=xiaomi/jasmine/jasmine_sprout:9/PKQ1.180904.001/9.7.23:user/release-keys</span><br><span class="line">post-build-incremental=9.7.23</span><br><span class="line">post-sdk-level=28</span><br><span class="line">post-security-patch-level=2019-08-05</span><br><span class="line">post-timestamp=1563835614</span><br><span class="line">pre-device=jasmine_sprout</span><br></pre></td></tr></table></figure>

<ul>
<li>生成完整OTA<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./build/tools/releasetools/ota_from_target_files \</span><br><span class="line">  dist_output/tardis-target_files.zip ota_update.zip</span><br></pre></td></tr></table></figure>
-生成增量 OTA<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./build/tools/releasetools/ota_from_target_files \</span><br><span class="line">  -i PREVIOUS-tardis-target_files.zip \</span><br><span class="line">  dist_output/tardis-target_files.zip incremental_ota_update.zip</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="开机服务启动代码分析"><a href="#开机服务启动代码分析" class="headerlink" title="开机服务启动代码分析"></a>开机服务启动代码分析</h2><p>update_verifier</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">vendor/etc/init/hw/init.target.rc</span><br><span class="line">on fs</span><br><span class="line">    mount_all /vendor/etc/fstab.qcom</span><br><span class="line"></span><br><span class="line">do_mount_all</span><br><span class="line">mount_fstab_return_code = mount_fstab(fstabfile, mount_mode);</span><br><span class="line">/* queue_fs_event will queue event based on mount_fstab return code</span><br><span class="line"> * and return processed return code*/</span><br><span class="line">auto queue_fs_result = queue_fs_event(*mount_fstab_return_code);</span><br><span class="line"></span><br><span class="line">else if (code == FS_MGR_MNTALL_DEV_MIGHT_BE_ENCRYPTED) &#123;</span><br><span class="line">        property_set(&quot;ro.crypto.state&quot;, &quot;encrypted&quot;);</span><br><span class="line">        property_set(&quot;ro.crypto.type&quot;, &quot;block&quot;);</span><br><span class="line">        ActionManager::GetInstance().QueueEventTrigger(&quot;defaultcrypto&quot;);</span><br><span class="line">        return Success();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">on defaultcrypto</span><br><span class="line">    exec - root -- /system/bin/vdc --wait cryptfs mountdefaultencrypted</span><br><span class="line">    # vold will set vold.decrypt to trigger_restart_framework (default</span><br><span class="line">    # encryption) or trigger_restart_min_framework (other encryption)</span><br><span class="line"></span><br><span class="line">trigger_restart_min_framework</span><br><span class="line"></span><br><span class="line">on property:vold.decrypt=trigger_post_fs_data</span><br><span class="line">    trigger post-fs-data</span><br><span class="line">    trigger zygote-start</span><br><span class="line"></span><br><span class="line">on zygote-start &amp;&amp; property:ro.crypto.state=encrypted &amp;&amp; property:ro.crypto.type=file</span><br><span class="line">    # A/B update verifier that marks a successful boot.</span><br><span class="line">    exec_start update_verifier_nonencrypted</span><br><span class="line">    start netd</span><br><span class="line">    start zygote</span><br><span class="line">    start zygote_secondary</span><br><span class="line"></span><br><span class="line">service update_verifier_nonencrypted /system/bin/update_verifier nonencrypted</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="AB-升级过程调试"><a href="#AB-升级过程调试" class="headerlink" title="AB 升级过程调试"></a>AB 升级过程调试</h2><p>先制作ota升级包   make otapackage -j4<br>制作完成的升级包, 解压出payload.bin和payload_properties.txt<br>将升级包push到手机中, 执行命令:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">update_engine_client \</span><br><span class="line">--payload=file://stroage/emulated/0/payload.bin \</span><br><span class="line">--update \</span><br><span class="line">--headers=&quot;\</span><br><span class="line">  FILE_HASH=kIOSRpbVFbtwlQcrTILsXvoY9kibUtgD44jsw2Xt/sU= \</span><br><span class="line">  FILE_SIZE=1387785336 \</span><br><span class="line">  METADATA_HASH=K+wAnG6HAjz8ogpJ6pYjyIUtS52evVp59Bwsiw5taHI= \</span><br><span class="line">  METADATA_SIZE=104537 \</span><br><span class="line">&quot;</span><br></pre></td></tr></table></figure>
<p>logcat抓取update_engine的log, 发现报错:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">07-24 09:56:00.325  1045  1045 I update_engine: [0724/095600.325928:INFO:delta_performer.cc(1549)] Verifying payload using public key: /etc/update_engine/update-payload-key.pub.pem</span><br><span class="line">07-24 09:56:00.326  1045  1045 E update_engine: [0724/095600.325993:ERROR:delta_performer.cc(1563)] VerifyPayload failure: payload_hash_calculator_.raw_hash() == update_check_response_hash</span><br><span class="line">07-24 09:56:00.326  1045  1045 E update_engine: [0724/095600.326097:ERROR:download_action.cc(397)] Download of file://stroage/emulated/0/draco-ota-eng.mi.zip failed due to payload verification error.</span><br><span class="line">07-24 09:56:00.326  1045  1045 I update_engine: [0724/095600.326166:INFO:action_processor.cc(116)] ActionProcessor: finished DownloadAction with code ErrorCode::kPayloadHashMismatchError</span><br><span class="line">07-24 09:56:00.326  1045  1045 I update_engine: [0724/095600.326233:INFO:action_processor.cc(121)] ActionProcessor: Aborting processing due to failure.</span><br></pre></td></tr></table></figure>
<p>加log调试update_engine</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">adb root;adb disable-verity;adb reboot;adb root;adb remount;</span><br><span class="line">adb push system/bin/update_engine  /system/bin/</span><br><span class="line">adb shell;</span><br><span class="line">stop update_engine; start update_engine;</span><br></pre></td></tr></table></figure>
<p>发现该处log比较奇怪:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">07-23 16:59:54.693  5879  5879 I update_engine: [0723/165954.693766:INFO:install_plan.cc(83)] InstallPlan: new_update, version: , source_slot: A, target_slot: B, url: file://stroage/emulated/0/payload.bin, payload: (size: 0, metadata_size: 0, metadata signature: , hash: , payload type: unknown), hash_checks_mandatory: true, powerwash_required: false, switch_slot_on_reboot: true, run_post_install: true</span><br></pre></td></tr></table></figure>
<p>dump的地方在<code>update_attempter_android.cc</code>文件中<code>install_plan_.Dump();</code></p>
<p>最后调试下来发现是参数格式不对, 正确的应该这样写:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">update_engine_client \</span><br><span class="line">--payload=http://192.168.31.83:8000/payload.bin \</span><br><span class="line">--update \</span><br><span class="line">--headers=&quot;\</span><br><span class="line">FILE_HASH=HCN+qKtmcVpsRotGQCsi91Om+MqSg3NHQYJwn2yULVg=</span><br><span class="line">FILE_SIZE=2693182661</span><br><span class="line">METADATA_HASH=CUDPVlE0kWBn6+Ryaxta8lwvi03G4G9XK1vhRGPcm6U=</span><br><span class="line">METADATA_SIZE=165572</span><br><span class="line">&quot;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意换行符的写入方式</p>
</blockquote>
<p>在上面的尝试后, 发现本地地址不能解析<br>需要在本地电脑上架设小型服务器, </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">在升级包路径下执行</span></span><br><span class="line">python -mSimpleHTTPServer</span><br><span class="line">python -m http.server  #python3</span><br></pre></td></tr></table></figure>
<p>传入的参数为:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--payload=http://192.168.31.83:8000/payload.bin</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">update_engine_client \</span><br><span class="line">--payload=http://127.0.0.1/storage/emulated/0/payload.bin \</span><br><span class="line">--update \</span><br><span class="line">--headers=&quot;\</span><br><span class="line">FILE_HASH=kIOSRpbVFbtwlQcrTILsXvoY9kibUtgD44jsw2Xt/sU=</span><br><span class="line">FILE_SIZE=1387785336</span><br><span class="line">METADATA_HASH=K+wAnG6HAjz8ogpJ6pYjyIUtS52evVp59Bwsiw5taHI=</span><br><span class="line">METADATA_SIZE=104537</span><br><span class="line">&quot;</span><br></pre></td></tr></table></figure>

<p>最后发现本地地址也是可以解析的, 只是路径名要写对:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--payload=file:///storage/emulated/0/payload.bin</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意file:后面三个’&#x2F;‘, 前两个是file的scheme, 后一个代表的是手机的根路径</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">update_engine_client \</span><br><span class="line">--payload=file:///data/media/0/payload.bin \</span><br><span class="line">--update \</span><br><span class="line">--headers=&quot;\</span><br><span class="line">FILE_HASH=sMDMFWlA/r/RvD2xmbhT10ujGbd3ZDgbIoFsguZgFk0=</span><br><span class="line">FILE_SIZE=2706624429</span><br><span class="line">METADATA_HASH=5pBczs+nemH35uaJ6dyKEM14jLXG6yHLRHW2SA7E548=</span><br><span class="line">METADATA_SIZE=165921</span><br><span class="line">&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">update_engine_client \</span><br><span class="line">--payload=file:///data/media/0/miui_VENUS_20.8.19_d6f849fa6a_11.0.zip \</span><br><span class="line">--update \</span><br><span class="line">--offset=1146 \</span><br><span class="line">--size=2758439770 \</span><br><span class="line">--headers=&quot;\</span><br><span class="line">FILE_HASH=rr3A+HtaJvZR9t6fy+Jb1+H/IkbeOWKHifx27a9ZQFU=</span><br><span class="line">FILE_SIZE=2758439770</span><br><span class="line">METADATA_HASH=eEzs5b5edkpltbmQdROP/k4t1UxfC/9XwRVIXZWvnmU=</span><br><span class="line">METADATA_SIZE=165216</span><br><span class="line">&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">update_engine_client \</span><br><span class="line">--payload=file:///sdcard/miui_VENUS_20.8.19_d6f849fa6a_11.0.zip \</span><br><span class="line">--offset=1187 \</span><br><span class="line">--update \</span><br><span class="line">--headers=&quot;\</span><br><span class="line">FILE_HASH=rr3A+HtaJvZR9t6fy+Jb1+H/IkbeOWKHifx27a9ZQFU=</span><br><span class="line">FILE_SIZE=2758439770</span><br><span class="line">METADATA_HASH=eEzs5b5edkpltbmQdROP/k4t1UxfC/9XwRVIXZWvnmU=</span><br><span class="line">METADATA_SIZE=165216</span><br><span class="line">&quot;</span><br><span class="line"></span><br><span class="line">update_engine_client \</span><br><span class="line">--payload=file:///data/ota_package/payload.bin \</span><br><span class="line">--update \</span><br><span class="line">--headers=&quot;\</span><br><span class="line">FILE_HASH=yU0BoWvLqOvJk19Qpmf4bHSUwaT0Ly3aNTlAlPTpNOo=</span><br><span class="line">FILE_SIZE=2692532199</span><br><span class="line">METADATA_HASH=XNNFmxx7ltGXUNshJa/sW7ulxs7aEiOMZxHwgZIcIo4=</span><br><span class="line">METADATA_SIZE=165572</span><br><span class="line">&quot;</span><br><span class="line"></span><br><span class="line">update_engine_client \</span><br><span class="line">--payload=file:///mnt/androidwritable/0/emulated/0/Download/payload.bin \</span><br><span class="line">--update \</span><br><span class="line">--headers=&quot;\</span><br><span class="line">FILE_HASH=yU0BoWvLqOvJk19Qpmf4bHSUwaT0Ly3aNTlAlPTpNOo=</span><br><span class="line">FILE_SIZE=2692532199</span><br><span class="line">METADATA_HASH=XNNFmxx7ltGXUNshJa/sW7ulxs7aEiOMZxHwgZIcIo4=</span><br><span class="line">METADATA_SIZE=165572</span><br><span class="line">&quot;</span><br><span class="line"></span><br><span class="line">update_engine_client \</span><br><span class="line">--payload=file:///storage/emulated/0/payload.bin \</span><br><span class="line">--update \</span><br><span class="line">--headers=&quot;\</span><br><span class="line">FILE_HASH=yU0BoWvLqOvJk19Qpmf4bHSUwaT0Ly3aNTlAlPTpNOo=</span><br><span class="line">FILE_SIZE=2692532199</span><br><span class="line">METADATA_HASH=XNNFmxx7ltGXUNshJa/sW7ulxs7aEiOMZxHwgZIcIo4=</span><br><span class="line">METADATA_SIZE=165572</span><br><span class="line">&quot;</span><br><span class="line"></span><br><span class="line">update_engine_client \</span><br><span class="line">--payload=file:///data/ota_package/miui-ota-venus-20.9.1.root-20.9.2.root-a6a89c0203-11.0.zip \</span><br><span class="line">--update \</span><br><span class="line">--offset=1414 \</span><br><span class="line">--headers=&quot;\</span><br><span class="line">FILE_HASH=k6xH0maRm8TA3oiSUW3XaaVK7O1OXmVHuKl36ktTGYQ=</span><br><span class="line">FILE_SIZE=76627669</span><br><span class="line">METADATA_HASH=PsdtZ4XoOm6uBdfC9yS6PAPJ1LqPAu0dH/FMtoZcXGo=</span><br><span class="line">METADATA_SIZE=449549</span><br><span class="line">&quot;</span><br><span class="line">update_engine_client \</span><br><span class="line">--payload=file:///data/ota_package/payload.bin \</span><br><span class="line">--update \</span><br><span class="line">--headers=&quot;\</span><br><span class="line">FILE_HASH=6Rp2NEldT3Hsvo3amsrFM3cVypJW+3Zz9mSjLRpoQ68=</span><br><span class="line">FILE_SIZE=76627710</span><br><span class="line">METADATA_HASH=/Ilv5kgPOpsDwdtG8TUBCt08LFndNHHy/UXQMmsp3Hk=</span><br><span class="line">METADATA_SIZE=450810</span><br><span class="line">&quot;</span><br><span class="line"></span><br><span class="line">update_engine_client \</span><br><span class="line">--payload=file:///data/ota_package/payload.bin \</span><br><span class="line">--update \</span><br><span class="line">--headers=&quot;\</span><br><span class="line">FILE_HASH=fhPRX5CaUAmedhRy1E8Ee9lAib+pb9uMd1cb+fzx638=</span><br><span class="line">FILE_SIZE=181915047</span><br><span class="line">METADATA_HASH=tUuwjykp1KDc2C1ME+YOZn9tOnHhDzP2ukNFqKVf/tQ=</span><br><span class="line">METADATA_SIZE=607150</span><br><span class="line">&quot;</span><br><span class="line">openssl pkcs8 -in build/make/target/product/security/testkey.pk8 -inform DER -nocrypt &gt; test/private_key</span><br><span class="line">sha256sum header.bin | xxd -r -p | tee sha256.file</span><br><span class="line">dd if=sha256.file of=sha256_32.bin bs=1 count=32</span><br><span class="line">openssl pkeyutl -sign -inkey private_key -pkeyopt digest:sha256 -in sha256_32.bin -out header_sign.bin</span><br><span class="line"></span><br><span class="line">ota_from_target_files.py cmd:  -i /tmp/tmp.miui.target_files_package.ota.l4f/new-incremental-target-files.zip /tmp/tmp.miui.target_files_package.ota.l4f/new-target-files.zip /home/work/venus-r-dev-temp/20.9.9/root/ota_diff/ota-venus-20.9.6.root-20.9.9.root.zip</span><br><span class="line">build/tools/releasetools/ota_from_target_files  -i /tmp/tmp.miui.target_files_package.ota.l4f/new-incremental-target-files.zip /tmp/tmp.miui.target_files_package.ota.l4f/new-target-files.zip /home/work/venus-r-dev-temp/20.9.9/root/ota_diff/ota-venus-20.9.6.root-20.9.9.root.zip</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">build/tools/releasetools/ota_from_target_files  -i  /tmp/tmp.miui.target_files_package.ota.l4f/new-target-files.zip /home/work/venus-r-dev-temp/20.9.9/root/ota_diff/ota-venus-20.9.6.root-20.9.9.root.zip</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CMD: build/tools/releasetools/ota_from_target_files --block --payload_signer /home/builder/ota-tools/build/payload_signer.sh -i /tmp/tmp.miui.target_files_package.ota.Ds0/new-incremental-target-files.zip /tmp/tmp.miui.target_files_package.ota.Ds0/new-target-files.zip /home/work/venus-r-dev-temp/20.9.9/normal/ota_diff/blockota-venus-20.9.6-20.9.9.zip</span><br></pre></td></tr></table></figure>

<blockquote>
<p>算hash值的方法</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sha256sum</span> -t  signed_venus-target_files-20.9.1.root-11.0/RADIO/abl.elf | xxd -r -p | <span class="built_in">base64</span></span><br></pre></td></tr></table></figure>

<h3 id="添加firmware分区"><a href="#添加firmware分区" class="headerlink" title="添加firmware分区"></a>添加firmware分区</h3><p>先看下target_files依赖的RADIO文件:</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">TARGET_RADIO_FILES := xbl.elf xbl_config.elf imagefv.elf tz.mbn \</span><br><span class="line">                      devcfg.mbn storsec.mbn km4.mbn cmnlib.mbn \</span><br><span class="line">                      cmnlib64.mbn uefi_sec.mbn aop.mbn NON-HLOS.bin BTFM.bin dspso.bin \</span><br><span class="line">                      qupv3fw.elf multi_image.mbn hyp.mbn hypvm.mbn</span><br></pre></td></tr></table></figure>
<p>看下非AB升级的升级脚本:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">package_extract_file(&quot;firmware-update/cmnlib64.mbn&quot;, &quot;/dev/block/bootdevice/by-name/cmnlib64&quot;);</span><br><span class="line">package_extract_file(&quot;firmware-update/NON-HLOS.bin&quot;, &quot;/dev/block/bootdevice/by-name/modem&quot;);</span><br><span class="line">package_extract_file(&quot;firmware-update/cmnlib.mbn&quot;, &quot;/dev/block/bootdevice/by-name/cmnlib&quot;);</span><br><span class="line">package_extract_file(&quot;firmware-update/BTFM.bin&quot;, &quot;/dev/block/bootdevice/by-name/bluetooth&quot;);</span><br><span class="line">package_extract_file(&quot;firmware-update/km4.mbn&quot;, &quot;/dev/block/bootdevice/by-name/keymaster&quot;);</span><br><span class="line">package_extract_file(&quot;firmware-update/hypvm.mbn&quot;, &quot;/dev/block/bootdevice/by-name/hypbak&quot;);</span><br><span class="line">package_extract_file(&quot;firmware-update/tz.mbn&quot;, &quot;/dev/block/bootdevice/by-name/tz&quot;);</span><br><span class="line">package_extract_file(&quot;firmware-update/aop.mbn&quot;, &quot;/dev/block/bootdevice/by-name/aop&quot;);</span><br><span class="line">package_extract_file(&quot;firmware-update/xbl_config.elf&quot;, &quot;/dev/block/bootdevice/by-name/xbl_config&quot;);</span><br><span class="line">package_extract_file(&quot;firmware-update/storsec.mbn&quot;, &quot;/dev/block/bootdevice/by-name/storsec&quot;);</span><br><span class="line">package_extract_file(&quot;firmware-update/uefi_sec.mbn&quot;, &quot;/dev/block/bootdevice/by-name/uefisecapp&quot;);</span><br><span class="line">package_extract_file(&quot;firmware-update/imagefv.elf&quot;, &quot;/dev/block/bootdevice/by-name/imagefv&quot;);</span><br><span class="line">package_extract_file(&quot;firmware-update/qupv3fw.elf&quot;, &quot;/dev/block/bootdevice/by-name/qupfw&quot;);</span><br><span class="line">package_extract_file(&quot;firmware-update/abl.elf&quot;, &quot;/dev/block/bootdevice/by-name/abl&quot;);</span><br><span class="line">package_extract_file(&quot;firmware-update/dspso.bin&quot;, &quot;/dev/block/bootdevice/by-name/dsp&quot;);</span><br><span class="line">package_extract_file(&quot;firmware-update/devcfg.mbn&quot;, &quot;/dev/block/bootdevice/by-name/devcfg&quot;);</span><br><span class="line">package_extract_file(&quot;firmware-update/xbl.elf&quot;, &quot;/dev/block/bootdevice/by-name/xbl&quot;);</span><br><span class="line">package_extract_file(&quot;firmware-update/hyp.mbn&quot;, &quot;/dev/block/bootdevice/by-name/hyp&quot;);</span><br><span class="line">package_extract_file(&quot;firmware-update/vbmeta.img&quot;, &quot;/dev/block/bootdevice/by-name/vbmeta&quot;);</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">package_extract_file(<span class="string">&quot;firmware-update/logo.img&quot;</span>, <span class="string">&quot;/dev/block/bootdevice/by-name/logo&quot;</span>);</span></span><br><span class="line">package_extract_file(&quot;firmware-update/ifaa.img&quot;, &quot;/dev/block/bootdevice/by-name/ifaa&quot;);</span><br><span class="line">package_extract_file(&quot;firmware-update/dtbo.img&quot;, &quot;/dev/block/bootdevice/by-name/dtbo&quot;);</span><br></pre></td></tr></table></figure>
<p>上面的分区和有b分区的比下来, 除了logo, 其他的都要升级, 注意跟多出来的b分区的对比, 少了一个分区是<code>multiimgoem</code>, 对应的镜像<code>multi_image.mbn</code></p>
<h4 id="原生打包的方式"><a href="#原生打包的方式" class="headerlink" title="原生打包的方式"></a>原生打包的方式</h4><p>先看下<code>AB_OTA_PARTITIONS</code>的作用范围<br>META&#x2F;ab_partitions.txt<br>现有逻辑是查device&#x2F;board下定义的AB_OTA_PARTITIONS, 将扫到的分区写到target-files的这个文件中<br>由<code>/system/update_engine/scripts/brillo_update_payload</code>的generate生成对应的payload.bin<br>该文件为shell脚本, 编译时会被拷贝到<code>/out/host/linux-x86/bin</code>下面<br>原生方式只识别后缀名为<code>.img</code>的镜像文件, 在<code>add_img_to_target_files</code>制作target-files时, 会将<code>RADIO</code>目录下的后缀为<code>.img</code>的镜像文件拷贝到<code>IMAGES</code>下.<br>由<code>brillo_update_payload</code>脚本根据<code>IMAGES</code>下的镜像文件和<code>ab_partitions.txt</code>文件中的升级分区生成对应的升级包</p>
<h4 id="firmware的相关修改"><a href="#firmware的相关修改" class="headerlink" title="firmware的相关修改"></a>firmware的相关修改</h4><p>将firmware加到升级序列时, 有下面几个问题要解决</p>
<p>a. firmware的大部分镜像都不是<code>img</code>后缀结尾的</p>
<p>b. 需要按board按需添加对应的firmware, 最好不要写死</p>
<p>c. firmware的镜像放在<code>RADIO</code>而非<code>IMAGES</code>下,  这点有正式签名的考虑.(正式包会在Makefile执行完成后, 对做出的target-files下的IMAGES目录下的文件进行删除, 重新生成并签上正式签名), 因此不宜将firmware的镜像仿照原生逻辑直接拷贝到<code>IMAGES</code>下</p>
<p>d. firmware的镜像大部分跟其对应的分区名称名字不是对应的.</p>
<p>综上几点, 考虑的修改方式为:</p>
<ol>
<li>复用Board下的filesmap文件, 该文件定义了firmware镜像跟分区名称的对应规则, 该文件已经被打包到<code>target-files</code>下的<code>RADIO</code>目录下</li>
<li>ab_partitions的firmware的添加规则和原生的区分, 原生的是在宏<code>AB_OTA_PARTITIONS</code>下添加的, firmware的加入时机直接在<code>add_img_to_target_files</code>中对AB的操作时触发. 因<code>RADIO</code>目录下的文件已经是按board需要添加的, 可以直接扫描<code>RADIO</code>目录的文件, 且与<code>filesmap</code>文件中对应的即为所要升级的分区. (主要排除掉没有b slot的分区), 追加到<code>META/ab_partitions.txt</code>文件中.</li>
<li>由于上面的<strong>d</strong>项, 分区名跟镜像名不对应, 这里复用<code>filesmap</code>文件, 添加分区名跟镜像名的映射map, 写入到<code>META/ab_partitions_map.txt</code>文件中</li>
<li><code>brillo_update_payload</code>脚本中修改, 将只从<code>IMAGES</code>中和分区名和镜像名严格匹配的规则修改, 变更为除去IMAGES中已知的分区, 其他按照<code>META/ab_partitions_map.txt</code>的对应规则从<code>RADIO</code>目录取镜像文件.</li>
</ol>
<p>相关修改:</p>
<p><a target="_blank" rel="noopener" href="http://gerritlvs.pt.miui.com/#/c/656495/">http://gerritlvs.pt.miui.com/#/c/656495/</a></p>
<p><a target="_blank" rel="noopener" href="http://gerritlvs.pt.miui.com/#/c/656506/">http://gerritlvs.pt.miui.com/#/c/656506/</a></p>
<h3 id="升级完成与切换slot"><a href="#升级完成与切换slot" class="headerlink" title="升级完成与切换slot"></a>升级完成与切换slot</h3><p>查看主系统中是否已经升级完了对应的slot</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`#升级plan``07-26 13``:``17``:``36.537  1120  1120 I update_engine``:` `[``0726/131736``.537426:``INFO``:``install_plan.cc(83)``]` `InstallPlan``:` `new_update``,` `version``:` `,` `source_slot``:` `A``,` `target_slot``:` `B``,` `url``:` `file``:``///storage/emulated/0/payload.bin``,` `payload``:` `(size``:` `2004454082``,` `metadata_size``:` `174654``,` `metadata signature``:` `,` `hash``:` `7FE331728BDC1F3ADB6CD99DB86E9B9C49613464A0B4CEDB996B2035AF58BC82``,` `payload type``:` `unknown)``,` `hash_checks_mandatory``:` `false``,` `powerwash_required``:` `false``,` `switch_slot_on_reboot``:` `true``,` `run_post_install``:` `true``#升级顺序及hash值``07-26 13``:``17``:``36.808  1120  1120 I update_engine``:` `[``0726/131736``.808861:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new boot sha256``:` `BaT0kJm5qUoDs+ZFvbl7PsbYrJdVLEJ4AO9yRubxVxA= size``:` `134217728``07-26 13``:``17``:``36.809  1120  1120 I update_engine``:` `[``0726/131736``.809403:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new system sha256``:` `8iUdw5zmngS2Z19bJdjhyoinOuPf+jktNpsybrg+/As= size``:` `3758096384``07-26 13``:``17``:``36.809  1120  1120 I update_engine``:` `[``0726/131736``.809555:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new vendor sha256``:` `yoK6GkBeRI140U9nC5PeOcoTIKvX9PytKJveI9W0NZI= size``:` `2134900736``07-26 13``:``17``:``36.809  1120  1120 I update_engine``:` `[``0726/131736``.809695:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new cmnlib sha256``:` `L8grDzXzgCj2jmkywxgvC6WOESQbzcQWzC2XKDuAXCk= size``:` `393216``07-26 13``:``17``:``36.809  1120  1120 I update_engine``:` `[``0726/131736``.809828:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new cmnlib64 sha256``:` `2kJkRo4mMiPlSXilsbdN8jrDnWHVpy0n+C72qnjxUXI= size``:` `512000``07-26 13``:``17``:``36.809  1120  1120 I update_engine``:` `[``0726/131736``.809953:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new xbl sha256``:` `0knDpqu+RIZDIFVQ+UfvIHdXd8itYU7kBZQjyFv3MSk= size``:` `3313664``07-26 13``:``17``:``36.810  1120  1120 I update_engine``:` `[``0726/131736``.810078:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new tz sha256``:` `qJjCTAzUUP4QDtP5JpEIgyiucu2csyDMMqm3Sw82IJ4= size``:` `3149824``07-26 13``:``17``:``36.810  1120  1120 I update_engine``:` `[``0726/131736``.810200:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new ifaa sha256``:` `jndrE4DvyUkcFkSlgGcdzT31y61NFbs0bK62w7RxZmc= size``:` `67108864``07-26 13``:``17``:``36.810  1120  1120 I update_engine``:` `[``0726/131736``.810332:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new xbl_config sha256``:` `EuJt+caPn+p1pYml7BiLHwWS5qOHdsE9XWdDMTgYDn8= size``:` `126976``07-26 13``:``17``:``36.810  1120  1120 I update_engine``:` `[``0726/131736``.810463:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new abl sha256``:` `AEWy9qn6ckS6oPuchaZTf3LLBKvu4rlVhCqjYuovjvo= size``:` `159744``07-26 13``:``17``:``36.810  1120  1120 I update_engine``:` `[``0726/131736``.810605:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new keymaster sha256``:` `2EbjQReoWN2RJxiMTYDY0DyBhTSCj9EDMQY8nBNkrhM= size``:` `253952``07-26 13``:``17``:``36.810  1120  1120 I update_engine``:` `[``0726/131736``.810735:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new bluetooth sha256``:` `QUIy2P5N0423Q9vfFStQ4gX7+93NNeNAP8/C1GMFRxs= size``:` `847872``07-26 13``:``17``:``36.810  1120  1120 I update_engine``:` `[``0726/131736``.810863:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new imagefv sha256``:` `s8nZ2bO3JQ1FhpHm5xl6JM0gaXD+R+bJXx/ao5n465c= size``:` `24576``07-26 13``:``17``:``36.811  1120  1120 I update_engine``:` `[``0726/131736``.810994:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new vbmeta sha256``:` `DS53zciAjgUcUu9bazzGzl8WSrXsTlyDh0qQdQrSzzg= size``:` `4096``07-26 13``:``17``:``36.811  1120  1120 I update_engine``:` `[``0726/131736``.811124:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new qupfw sha256``:` `5b7DvDYxu52A7CkzLEn17FAUi9VjC4+hP1x1EHgVwn4= size``:` `73728``07-26 13``:``17``:``36.811  1120  1120 I update_engine``:` `[``0726/131736``.811248:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new dtbo sha256``:` `x8LJxRjY6eyLtnFpCUjx0nm7KrPk5EWmbO1RoiGgdKA= size``:` `33554432``07-26 13``:``17``:``36.811  1120  1120 I update_engine``:` `[``0726/131736``.811380:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new hyp sha256``:` `K+Lhh6fNlCzcZGO2sSQk4oX899HivC4ZYbQ00wCHJuk= size``:` `487424``07-26 13``:``17``:``36.811  1120  1120 I update_engine``:` `[``0726/131736``.811501:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new aop sha256``:` `pbPjmwNuZ63U/yB3x6fWwHMFaWTaO7GRsvvmgtYeZY8= size``:` `204800``07-26 13``:``17``:``36.811  1120  1120 I update_engine``:` `[``0726/131736``.811628:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new modem sha256``:` `U8mQP9s3QEIuQC6XjTtCK2FSv37BrFmz/8yanfrSag0= size``:` `254750720``07-26 13``:``17``:``36.811  1120  1120 I update_engine``:` `[``0726/131736``.811752:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new dsp sha256``:` `/6W7ecrFfr/L/iQIyc31iyatytPv/Zh3ihPgkKCRogg= size``:` `67108864``07-26 13``:``17``:``36.811  1120  1120 I update_engine``:` `[``0726/131736``.811871:``INFO``:``delta_performer.cc(400)``]` `PartitionInfo new devcfg sha256``:` `op2nGXrz70xk67DA0MGvGxuPrWGEDS/zQHo8wzSSG3E= size``:` `57344``#写入分区``...``07-26 13``:``26``:``23.407  1120  1120 I update_engine``:` `[``0726/132623``.406974:``INFO``:``delta_performer.cc(386)``]` `Applying 32 operations to partition ``&quot;ifaa&quot;``07-26 13``:``26``:``25.604  1120  1120 I update_engine``:` `[``0726/132625``.604203:``INFO``:``delta_performer.cc(374)``]` `Opening /dev/block/bootdevice/by-name/xbl_config_b partition without O_DSYNC``07-26 13``:``26``:``25.609  1120  1120 I update_engine``:` `[``0726/132625``.609049:``INFO``:``delta_performer.cc(126)``]` `Caching writes.``07-26 13``:``26``:``25.609  1120  1120 I update_engine``:` `[``0726/132625``.609407:``INFO``:``delta_performer.cc(386)``]` `Applying 1 operations to partition ``&quot;xbl_config&quot;``07-26 13``:``26``:``25.638  1120  1120 I update_engine``:` `[``0726/132625``.638252:``INFO``:``delta_performer.cc(374)``]` `Opening /dev/block/bootdevice/by-name/abl_b partition without O_DSYNC``#分区写完后校验``07-26 13``:``27``:``40.528  1120  1120 I update_engine``:` `[``0726/132740``.528046:``INFO``:``filesystem_verifier_action.cc(108)``]` `Hashing partition 7 (ifaa) ``on` `device /dev/block/bootdevice/by-name/ifaa_b``07-26 13``:``27``:``40.870  1120  1120 I update_engine``:` `[``0726/132740``.870530:``INFO``:``filesystem_verifier_action.cc(199)``]` `Hash of ifaa``:` `jndrE4DvyUkcFkSlgGcdzT31y61NFbs0bK62w7RxZmc=``07-26 13``:``27``:``41.053  1120  1120 I update_engine``:` `[``0726/132741``.053396:``INFO``:``filesystem_verifier_action.cc(108)``]` `Hashing partition 8 (xbl_config) ``on` `device /dev/block/bootdevice/by-name/xbl_config_b``07-26 13``:``27``:``41.059  1120  1120 I update_engine``:` `[``0726/132741``.059842:``INFO``:``filesystem_verifier_action.cc(199)``]` `Hash of xbl_config``:` `EuJt+caPn+p1pYml7BiLHwWS5qOHdsE9XWdDMTgYDn8=``#升级完成``07-26 13``:``27``:``43.865  1120  1120 I update_engine``:` `[``0726/132743``.865773:``INFO``:``update_attempter_android.cc(439)``]` `Processing Done.``07-26 13``:``27``:``43.867  1120  1120 I update_engine``:` `[``0726/132743``.867692:``INFO``:``update_attempter_android.cc(447)``]` `Update successfully applied``,` `waiting to reboot.`</span><br></pre></td></tr></table></figure>

<p>重启手机查看是否切换了slot</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`fastboot getvar current-slot`</span><br></pre></td></tr></table></figure>

<p>fastboot 手动切换slot</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`fastboot set_active a|b`</span><br></pre></td></tr></table></figure>

<p>在主系统下查看是否已经切换了slot:</p>
<p>可以通过mount查看挂载的是否是对应slot的分区, 也可以重新执行update_engine_client查看source slot.</p>
<p>其他的fastboot相关命令和变量:</p>
<ul>
<li><code>has-slot:&lt;partition-base-name-without-suffix&gt;</code>：如果指定分区支持插槽，则返回“yes”，否则返回“no”。</li>
<li><code>current-slot</code>：返回接下来将从中启动的插槽后缀。</li>
<li><code>slot-count</code>：返回一个表示可用插槽数量的整数。目前支持两个插槽，因此该值为 <code>2</code>。</li>
<li><code>slot-successful:&lt;slot-suffix&gt;</code>：如果指定插槽已标记为成功启动，则返回“yes”，否则返回“no”。</li>
<li><code>slot-unbootable:&lt;slot-suffix&gt;</code>：如果指定插槽被标记为不可启动，则返回“yes”，否则返回“no”。</li>
<li><code>slot-retry-count</code>：启动指定插槽的剩余重试次数。</li>
</ul>
<h2 id="recovery升级X-slot"><a href="#recovery升级X-slot" class="headerlink" title="recovery升级X_slot"></a>recovery升级X_slot</h2><p>recovery借助update_engine_sideload进行AB系统的升级, 过程与主系统中的大体类似, 跳过hidl服务直连hal的静态库.</p>
<p>适配时需要将bootctl的hal的静态库接入update_engine_sideload.</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Enable update engine sideloading by including the static version of the</span></span><br><span class="line"><span class="comment"># boot_control HAL and its dependencies.</span></span><br><span class="line">PRODUCT_STATIC_BOOT_CONTROL_HAL := \</span><br><span class="line">    bootctrl.msmnile \</span><br><span class="line">    librecovery_updater_msm \</span><br><span class="line">    libz \</span><br><span class="line">    libcutils</span><br><span class="line"></span><br><span class="line">PRODUCT_PACKAGES += \</span><br><span class="line">    update_engine_sideload</span><br></pre></td></tr></table></figure>

<p>qcom的bootctrl.msmnile库并没有静态版本, 将其改造成静态版本, 同时注意platform的binary不能访问vendor的静态库, 需要去掉vendor属性</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[  137.119886] [0118/071802.275869:INFO:update_attempter_android.cc(163)] headers dump: FILE_HASH:XY0N+WNwMUsufo4R2WhiVEZZysKndtGOs2U2eHI4vWY=</span><br><span class="line">[  137.119974] [0118/071802.275959:INFO:update_attempter_android.cc(163)] headers dump: FILE_SIZE:2172949036</span><br><span class="line">[  137.120064] [0118/071802.276047:INFO:update_attempter_android.cc(163)] headers dump: METADATA_HASH:tT9n0yD1oGTFh6CHfgFJ+SFDpGVDdM3MxU2Kj6J4xHk=</span><br><span class="line">[  137.120153] [0118/071802.276137:INFO:update_attempter_android.cc(163)] headers dump: METADATA_SIZE:201361</span><br><span class="line">[  137.314970] [0118/071802.470947:INFO:multi_range_http_fetcher.cc(74)] starting transfer of range 10118+2172949036</span><br></pre></td></tr></table></figure>

<p>sideload模式可以通过adb进行调试执行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">update_engine_sideload  --payload=file:///tmp/&lt;&gt;.zip  --offset=10118 --headers=&quot;\</span><br><span class="line">FILE_HASH=XY0N+WNwMUsufo4R2WhiVEZZysKndtGOs2U2eHI4vWY=</span><br><span class="line">FILE_SIZE=2172949036</span><br><span class="line">METADATA_HASH=tT9n0yD1oGTFh6CHfgFJ+SFDpGVDdM3MxU2Kj6J4xHk=</span><br><span class="line">METADATA_SIZE=201361</span><br><span class="line">&quot;</span><br><span class="line"></span><br><span class="line">update_engine_sideload  --payload=file:///tmp/update.zip  --offset=1418 --headers=&quot;\</span><br><span class="line">FILE_HASH=fhPRX5CaUAmedhRy1E8Ee9lAib+pb9uMd1cb+fzx638=</span><br><span class="line">FILE_SIZE=181915047</span><br><span class="line">METADATA_HASH=tUuwjykp1KDc2C1ME+YOZn9tOnHhDzP2ukNFqKVf/tQ=</span><br><span class="line">METADATA_SIZE=607150</span><br><span class="line">&quot;</span><br><span class="line"></span><br><span class="line">update_engine_sideload   --payload=file:///tmp/miui_DRACO_1.1.1_3b6efde15f_9.0.zip  --offset=10137 --headers=&quot;\^JFILE_HASH=2RuZP+op3uy6movkIOlNaNoo8Fev+++ndUN56eo4WtY=^JFILE_SIZE=2180626971^JMETADATA_HASH=nW8R4zd7YIn/U3ybQ4U8e104hOlJ/8LBWBAlLaV4teY=^JMETADATA_SIZE=201406^J&quot; </span><br></pre></td></tr></table></figure>

<p>相关log, 注意后面的size</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line">[0119/030730.113743:INFO:delta_performer.cc(1405)] Detected a &#x27;full&#x27; payload.</span><br><span class="line">[0119/030730.174037:INFO:delta_performer.cc(400)] PartitionInfo new boot sha256: EpKxremioCiMOtX/ll7vdGHgyPA6hkS+aEATJ1bTmvs= size: 134217728</span><br><span class="line">[0119/030730.174087:INFO:delta_performer.cc(400)] PartitionInfo new system sha256: a3cVb5cmEwvwXp9qRV7S/FHD88SUx5SdPdBL9vdtfdA= size: 4831838208</span><br><span class="line">[0119/030730.174108:INFO:delta_performer.cc(400)] PartitionInfo new vendor sha256: Hz4lmS/Ubd04ZcY3N2Z6Tn1hKcmYPjdeeHbyRCw3n6U= size: 2134900736</span><br><span class="line">[0119/030730.174124:INFO:delta_performer.cc(400)] PartitionInfo new cmnlib sha256: jobjLrtwvwr4lomr6gMHgT07CnYt+m2n9rimaAX8gmA= size: 393216</span><br><span class="line">[0119/030730.174142:INFO:delta_performer.cc(400)] PartitionInfo new hyp sha256: GBrSZwkKGzyPmjMln6hNqCs0MMdOnVNq+0xvPg9wEIo= size: 491520</span><br><span class="line">[0119/030730.174164:INFO:delta_performer.cc(400)] PartitionInfo new xbl sha256: Srhj/31G6kvceupG54iy2ATnvTrHaGDTNrXoQ9QoBQM= size: 3313664</span><br><span class="line">[0119/030730.174185:INFO:delta_performer.cc(400)] PartitionInfo new tz sha256: 6j6yJ6VEJP/eDEfVAfBTJsPeihIw8stgYx3IZYNUTjU= size: 3166208</span><br><span class="line">[0119/030730.174207:INFO:delta_performer.cc(400)] PartitionInfo new uefisecapp sha256: SsTDYAIGR57uuERCJVW4pYo7qliFTfFC0bjkeCdhuaA= size: 126976</span><br><span class="line">[0119/030730.174228:INFO:delta_performer.cc(400)] PartitionInfo new xbl_config sha256: PXsK2uY4CZHl9HTw4MNn2V2JKjf+tL5lF3Rsrxq/DlQ= size: 126976</span><br><span class="line">[0119/030730.174248:INFO:delta_performer.cc(400)] PartitionInfo new abl sha256: pTmXXhjn578lQoU4Ms2gevuE1u9lf6fkfKkeb2wErOc= size: 159744</span><br><span class="line">[0119/030730.174269:INFO:delta_performer.cc(400)] PartitionInfo new dsp sha256: kGaIexuCECjzYboVNAQWYgSk5+2ZDAreFTT+9Lae68I= size: 67108864</span><br><span class="line">[0119/030730.174290:INFO:delta_performer.cc(400)] PartitionInfo new bluetooth sha256: +o/xD1GaNQ+dXp3dI7cHLl/ecNQveGozZ5/+3mkysI0= size: 847872</span><br><span class="line">[0119/030730.174311:INFO:delta_performer.cc(400)] PartitionInfo new imagefv sha256: YtGPa6a7hx2vAUrQBMIID6821Cagh5hM7mfWvouDZjE= size: 24576</span><br><span class="line">[0119/030730.174332:INFO:delta_performer.cc(400)] PartitionInfo new vbmeta sha256: 8SxbQYbjPUCebXdmSJg7iJhcJbdkDKRbIozhlEfIly8= size: 4096</span><br><span class="line">[0119/030730.174353:INFO:delta_performer.cc(400)] PartitionInfo new qupfw sha256: QwIM5J4OBdFm+EJmlrp+443q7M7HHzGsyWp7/6a7rks= size: 73728</span><br><span class="line">[0119/030730.174374:INFO:delta_performer.cc(400)] PartitionInfo new keymaster sha256: QxPBL7CmuMS851FLt2IyJ1viO+NlEfrcLiVCveNrUZM= size: 258048</span><br><span class="line">[0119/030730.174394:INFO:delta_performer.cc(400)] PartitionInfo new dtbo sha256: J4XfTy8iKmEDrT2g3p/IFowpezxKk5O1eaT2SIt9siY= size: 33554432</span><br><span class="line">[0119/030730.174415:INFO:delta_performer.cc(400)] PartitionInfo new aop sha256: a/+FDfEjG5fT7d43Lt2kzG+Ij3hWIo9u5anzMHTctRU= size: 204800</span><br><span class="line">[0119/030730.174436:INFO:delta_performer.cc(400)] PartitionInfo new modem sha256: es49VhO5api6iwZjDt/DWLBqXA9DnJvRccmvEL5FK/Y= size: 250458112</span><br><span class="line">[0119/030730.174458:INFO:delta_performer.cc(400)] PartitionInfo new devcfg sha256: CNmqJR7BqkQgcJNdrtCYKCQrJVEgehBfe/eCQGm7/n8= size: 57344</span><br><span class="line">[0119/030730.174480:INFO:delta_performer.cc(400)] PartitionInfo new cmnlib64 sha256: CTW5va0C8mcZN2pg46xloHvD5tq1x61mHAMGoB7siqM= size: 512000</span><br><span class="line">[0119/030730.174508:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/boot_b partition without O_DSYNC</span><br><span class="line">[0119/030730.175562:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/030730.175616:INFO:delta_performer.cc(386)] Applying 64 operations to partition &quot;boot&quot;</span><br><span class="line">[0119/030730.175639:INFO:delta_performer.cc(601)] Starting to apply update payload operations</span><br><span class="line">[0119/030732.554195:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/system_b partition without O_DSYNC</span><br><span class="line">[0119/030732.555151:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/030732.555206:INFO:delta_performer.cc(386)] Applying 2304 operations to partition &quot;system&quot;</span><br><span class="line">[0119/030753.617572:INFO:delta_performer.cc(210)] Completed 356/3571 operations (9%), 260767744/2172949036 bytes downloaded (12%), overall progress 10%</span><br><span class="line">[0119/030809.120118:INFO:delta_performer.cc(210)] Completed 589/3571 operations (16%), 521519104/2172949036 bytes downloaded (24%), overall progress 20%</span><br><span class="line">[0119/030829.133342:INFO:delta_performer.cc(210)] Completed 858/3571 operations (24%), 814350336/2172949036 bytes downloaded (37%), overall progress 30%</span><br><span class="line">[0119/030847.818425:INFO:delta_performer.cc(210)] Completed 1132/3571 operations (31%), 1086488576/2172949036 bytes downloaded (50%), overall progress 40%</span><br><span class="line">[0119/030907.012157:INFO:delta_performer.cc(210)] Completed 1429/3571 operations (40%), 1329676288/2172949036 bytes downloaded (61%), overall progress 50%</span><br><span class="line">[0119/030914.390509:INFO:delta_performer.cc(210)] Completed 2072/3571 operations (58%), 1351565312/2172949036 bytes downloaded (62%), overall progress 60%</span><br><span class="line">[0119/030928.264078:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/vendor_b partition without O_DSYNC</span><br><span class="line">[0119/030928.265006:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/030928.265065:INFO:delta_performer.cc(386)] Applying 1018 operations to partition &quot;vendor&quot;</span><br><span class="line">[0119/030939.404319:INFO:delta_performer.cc(210)] Completed 2548/3571 operations (71%), 1521074176/2172949036 bytes downloaded (70%), overall progress 70%</span><br><span class="line">[0119/030959.073585:INFO:delta_performer.cc(210)] Completed 2786/3571 operations (78%), 1796096000/2172949036 bytes downloaded (82%), overall progress 80%</span><br><span class="line">[0119/031021.805564:INFO:delta_performer.cc(210)] Completed 3072/3571 operations (86%), 2056355840/2172949036 bytes downloaded (94%), overall progress 90%</span><br><span class="line">[0119/031031.406053:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/cmnlib_b partition without O_DSYNC</span><br><span class="line">[0119/031031.406953:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/031031.407007:INFO:delta_performer.cc(386)] Applying 1 operations to partition &quot;cmnlib&quot;</span><br><span class="line">[0119/031031.431870:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/hyp_b partition without O_DSYNC</span><br><span class="line">[0119/031031.432726:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/031031.432780:INFO:delta_performer.cc(386)] Applying 1 operations to partition &quot;hyp&quot;</span><br><span class="line">[0119/031031.457051:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/xbl_b partition without O_DSYNC</span><br><span class="line">[0119/031031.457909:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/031031.457962:INFO:delta_performer.cc(386)] Applying 2 operations to partition &quot;xbl&quot;</span><br><span class="line">[0119/031031.619811:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/tz_b partition without O_DSYNC</span><br><span class="line">[0119/031031.620741:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/031031.620795:INFO:delta_performer.cc(386)] Applying 2 operations to partition &quot;tz&quot;</span><br><span class="line">[0119/031031.728560:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/uefisecapp_b partition without O_DSYNC</span><br><span class="line">[0119/031031.729560:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/031031.729619:INFO:delta_performer.cc(386)] Applying 1 operations to partition &quot;uefisecapp&quot;</span><br><span class="line">[0119/031031.743096:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/xbl_config_b partition without O_DSYNC</span><br><span class="line">[0119/031031.743941:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/031031.743991:INFO:delta_performer.cc(386)] Applying 1 operations to partition &quot;xbl_config&quot;</span><br><span class="line">[0119/031031.755388:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/abl_b partition without O_DSYNC</span><br><span class="line">[0119/031031.756234:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/031031.756286:INFO:delta_performer.cc(386)] Applying 1 operations to partition &quot;abl&quot;</span><br><span class="line">[0119/031031.772838:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/dsp_b partition without O_DSYNC</span><br><span class="line">[0119/031031.773704:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/031031.773756:INFO:delta_performer.cc(386)] Applying 32 operations to partition &quot;dsp&quot;</span><br><span class="line">[0119/031033.057947:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/bluetooth_b partition without O_DSYNC</span><br><span class="line">[0119/031033.058886:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/031033.058940:INFO:delta_performer.cc(386)] Applying 1 operations to partition &quot;bluetooth&quot;</span><br><span class="line">[0119/031033.087545:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/imagefv_b partition without O_DSYNC</span><br><span class="line">[0119/031033.088426:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/031033.088481:INFO:delta_performer.cc(386)] Applying 1 operations to partition &quot;imagefv&quot;</span><br><span class="line">[0119/031033.100948:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/vbmeta_b partition without O_DSYNC</span><br><span class="line">[0119/031033.101786:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/031033.101837:INFO:delta_performer.cc(386)] Applying 1 operations to partition &quot;vbmeta&quot;</span><br><span class="line">[0119/031033.104208:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/qupfw_b partition without O_DSYNC</span><br><span class="line">[0119/031033.105069:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/031033.105116:INFO:delta_performer.cc(386)] Applying 1 operations to partition &quot;qupfw&quot;</span><br><span class="line">[0119/031033.110129:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/keymaster_b partition without O_DSYNC</span><br><span class="line">[0119/031033.111036:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/031033.111089:INFO:delta_performer.cc(386)] Applying 1 operations to partition &quot;keymaster&quot;</span><br><span class="line">[0119/031033.125200:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/dtbo_b partition without O_DSYNC</span><br><span class="line">[0119/031033.126050:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/031033.126100:INFO:delta_performer.cc(386)] Applying 16 operations to partition &quot;dtbo&quot;</span><br><span class="line">[0119/031033.477645:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/aop_b partition without O_DSYNC</span><br><span class="line">[0119/031033.478592:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/031033.478647:INFO:delta_performer.cc(386)] Applying 1 operations to partition &quot;aop&quot;</span><br><span class="line">[0119/031033.491181:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/modem_b partition without O_DSYNC</span><br><span class="line">[0119/031033.492024:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/031033.492075:INFO:delta_performer.cc(386)] Applying 120 operations to partition &quot;modem&quot;</span><br><span class="line">[0119/031041.771315:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/devcfg_b partition without O_DSYNC</span><br><span class="line">[0119/031041.772240:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/031041.772293:INFO:delta_performer.cc(386)] Applying 1 operations to partition &quot;devcfg&quot;</span><br><span class="line">[0119/031041.777995:INFO:delta_performer.cc(374)] Opening /dev/block/bootdevice/by-name/cmnlib64_b partition without O_DSYNC</span><br><span class="line">[0119/031041.778853:INFO:delta_performer.cc(126)] Caching writes.</span><br><span class="line">[0119/031041.778905:INFO:delta_performer.cc(386)] Applying 1 operations to partition &quot;cmnlib64&quot;</span><br><span class="line">[0119/031041.799262:INFO:delta_performer.cc(210)] Completed 3571/3571 operations (100%), 2172949036/2172949036 bytes downloaded (100%), overall progress 100%</span><br><span class="line">[0119/031041.799333:INFO:delta_performer.cc(1370)] Extracted signature data of size 264 at 2172747147</span><br><span class="line">[0119/031041.799367:INFO:multi_range_http_fetcher.cc(112)] terminating transfer</span><br><span class="line">[0119/031041.799397:INFO:multi_range_http_fetcher.cc(173)] Received transfer terminated.</span><br><span class="line">[0119/031041.799416:INFO:multi_range_http_fetcher.cc(124)] TransferEnded w/ code 200</span><br><span class="line">[0119/031041.799438:INFO:multi_range_http_fetcher.cc(137)] bytes_received_this_range_2172949036 range.length 2172949036</span><br><span class="line">[0119/031041.799456:INFO:multi_range_http_fetcher.cc(159)] Done w/ all transfers</span><br><span class="line">[0119/031041.805089:INFO:download_action.cc(374)] VerifyPayload</span><br><span class="line">[0119/031041.805152:INFO:delta_performer.cc(1549)] Verifying payload using public key: /etc/update_engine/update-payload-key.pub.pem</span><br><span class="line">[0119/031041.805172:INFO:delta_performer.cc(1563)] payload_hash_calculator_.raw_hash() == update_check_response_hash</span><br><span class="line">[0119/031041.805196:INFO:delta_performer.cc(1593)] Payload hash matches value in payload.</span><br><span class="line">[0119/031041.805236:INFO:download_action.cc(397)] Collections of histograms for UpdateEngine.DownloadAction.</span><br><span class="line">Histogram: UpdateEngine.DownloadAction.InstallOperation::REPLACE.Duration recorded 3571 samples, mean = 46.2</span><br><span class="line">0    ------------------------------------------------------------------------O (1381 = 38.7%)</span><br><span class="line">10   ---O                                                                      (50 = 1.4%) &#123;38.7%&#125;</span><br><span class="line">18   ---------O                                                                (164 = 4.6%) &#123;40.1%&#125;</span><br><span class="line">32   -----------------------------------O                                      (667 = 18.7%) &#123;44.7%&#125;</span><br><span class="line">57   ------------------------------------------------O                         (923 = 25.8%) &#123;63.3%&#125;</span><br><span class="line">101  --------------------O                                                     (386 = 10.8%) &#123;89.2%&#125;</span><br><span class="line">179  ... </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[0119/031041.805296:INFO:action_processor.cc(116)] ActionProcessor: finished DownloadAction with code ErrorCode::kSuccess</span><br><span class="line">[0119/031041.805312:INFO:action_processor.cc(143)] ActionProcessor: starting FilesystemVerifierAction</span><br><span class="line">[0119/031041.805334:INFO:filesystem_verifier_action.cc(108)] Hashing partition 0 (boot) on device /dev/block/bootdevice/by-name/boot_b</span><br><span class="line">[0119/031042.385142:INFO:filesystem_verifier_action.cc(199)] Hash of boot: EpKxremioCiMOtX/ll7vdGHgyPA6hkS+aEATJ1bTmvs=</span><br><span class="line">[0119/031042.483456:INFO:filesystem_verifier_action.cc(108)] Hashing partition 1 (system) on device /dev/block/bootdevice/by-name/system_b</span><br><span class="line">[0119/031103.269791:INFO:filesystem_verifier_action.cc(199)] Hash of system: a3cVb5cmEwvwXp9qRV7S/FHD88SUx5SdPdBL9vdtfdA=</span><br><span class="line">[0119/031106.812035:INFO:filesystem_verifier_action.cc(108)] Hashing partition 2 (vendor) on device /dev/block/bootdevice/by-name/vendor_b</span><br><span class="line">[0119/031116.011647:INFO:filesystem_verifier_action.cc(199)] Hash of vendor: Hz4lmS/Ubd04ZcY3N2Z6Tn1hKcmYPjdeeHbyRCw3n6U=</span><br><span class="line">[0119/031117.573949:INFO:filesystem_verifier_action.cc(108)] Hashing partition 3 (cmnlib) on device /dev/block/bootdevice/by-name/cmnlib_b</span><br><span class="line">[0119/031117.581216:INFO:filesystem_verifier_action.cc(199)] Hash of cmnlib: jobjLrtwvwr4lomr6gMHgT07CnYt+m2n9rimaAX8gmA=</span><br><span class="line">[0119/031117.582299:INFO:filesystem_verifier_action.cc(108)] Hashing partition 4 (hyp) on device /dev/block/bootdevice/by-name/hyp_b</span><br><span class="line">[0119/031117.586890:INFO:filesystem_verifier_action.cc(199)] Hash of hyp: GBrSZwkKGzyPmjMln6hNqCs0MMdOnVNq+0xvPg9wEIo=</span><br><span class="line">[0119/031117.589001:INFO:filesystem_verifier_action.cc(108)] Hashing partition 5 (xbl) on device /dev/block/bootdevice/by-name/xbl_b</span><br><span class="line">[0119/031117.605620:INFO:filesystem_verifier_action.cc(199)] Hash of xbl: Srhj/31G6kvceupG54iy2ATnvTrHaGDTNrXoQ9QoBQM=</span><br><span class="line">[0119/031117.608525:INFO:filesystem_verifier_action.cc(108)] Hashing partition 6 (tz) on device /dev/block/bootdevice/by-name/tz_b</span><br><span class="line">[0119/031117.624519:INFO:filesystem_verifier_action.cc(199)] Hash of tz: 6j6yJ6VEJP/eDEfVAfBTJsPeihIw8stgYx3IZYNUTjU=</span><br><span class="line">[0119/031117.627394:INFO:filesystem_verifier_action.cc(108)] Hashing partition 7 (uefisecapp) on device /dev/block/bootdevice/by-name/uefisecapp_b</span><br><span class="line">[0119/031117.630008:INFO:filesystem_verifier_action.cc(199)] Hash of uefisecapp: SsTDYAIGR57uuERCJVW4pYo7qliFTfFC0bjkeCdhuaA=</span><br><span class="line">[0119/031117.630216:INFO:filesystem_verifier_action.cc(108)] Hashing partition 8 (xbl_config) on device /dev/block/bootdevice/by-name/xbl_config_b</span><br><span class="line">[0119/031117.632794:INFO:filesystem_verifier_action.cc(199)] Hash of xbl_config: PXsK2uY4CZHl9HTw4MNn2V2JKjf+tL5lF3Rsrxq/DlQ=</span><br><span class="line">[0119/031117.632997:INFO:filesystem_verifier_action.cc(108)] Hashing partition 9 (abl) on device /dev/block/bootdevice/by-name/abl_b</span><br><span class="line">[0119/031117.635997:INFO:filesystem_verifier_action.cc(199)] Hash of abl: pTmXXhjn578lQoU4Ms2gevuE1u9lf6fkfKkeb2wErOc=</span><br><span class="line">[0119/031117.638910:INFO:filesystem_verifier_action.cc(108)] Hashing partition 10 (dsp) on device /dev/block/bootdevice/by-name/dsp_b</span><br><span class="line">[0119/031117.929656:INFO:filesystem_verifier_action.cc(199)] Hash of dsp: kGaIexuCECjzYboVNAQWYgSk5+2ZDAreFTT+9Lae68I=</span><br><span class="line">[0119/031117.978875:INFO:filesystem_verifier_action.cc(108)] Hashing partition 11 (bluetooth) on device /dev/block/bootdevice/by-name/bluetooth_b</span><br><span class="line">[0119/031117.986127:INFO:filesystem_verifier_action.cc(199)] Hash of bluetooth: +o/xD1GaNQ+dXp3dI7cHLl/ecNQveGozZ5/+3mkysI0=</span><br><span class="line">[0119/031117.986856:INFO:filesystem_verifier_action.cc(108)] Hashing partition 12 (imagefv) on device /dev/block/bootdevice/by-name/imagefv_b</span><br><span class="line">[0119/031117.988422:INFO:filesystem_verifier_action.cc(199)] Hash of imagefv: YtGPa6a7hx2vAUrQBMIID6821Cagh5hM7mfWvouDZjE=</span><br><span class="line">[0119/031117.988506:INFO:filesystem_verifier_action.cc(108)] Hashing partition 13 (vbmeta) on device /dev/block/bootdevice/by-name/vbmeta_b</span><br><span class="line">[0119/031117.989126:INFO:filesystem_verifier_action.cc(199)] Hash of vbmeta: 8SxbQYbjPUCebXdmSJg7iJhcJbdkDKRbIozhlEfIly8=</span><br><span class="line">[0119/031117.989176:INFO:filesystem_verifier_action.cc(108)] Hashing partition 14 (qupfw) on device /dev/block/bootdevice/by-name/qupfw_b</span><br><span class="line">[0119/031117.990481:INFO:filesystem_verifier_action.cc(199)] Hash of qupfw: QwIM5J4OBdFm+EJmlrp+443q7M7HHzGsyWp7/6a7rks=</span><br><span class="line">[0119/031117.990598:INFO:filesystem_verifier_action.cc(108)] Hashing partition 15 (keymaster) on device /dev/block/bootdevice/by-name/keymaster_b</span><br><span class="line">[0119/031117.993895:INFO:filesystem_verifier_action.cc(199)] Hash of keymaster: QxPBL7CmuMS851FLt2IyJ1viO+NlEfrcLiVCveNrUZM=</span><br><span class="line">[0119/031117.996472:INFO:filesystem_verifier_action.cc(108)] Hashing partition 16 (dtbo) on device /dev/block/bootdevice/by-name/dtbo_b</span><br><span class="line">[0119/031118.143676:INFO:filesystem_verifier_action.cc(199)] Hash of dtbo: J4XfTy8iKmEDrT2g3p/IFowpezxKk5O1eaT2SIt9siY=</span><br><span class="line">[0119/031118.168441:INFO:filesystem_verifier_action.cc(108)] Hashing partition 17 (aop) on device /dev/block/bootdevice/by-name/aop_b</span><br><span class="line">[0119/031118.171454:INFO:filesystem_verifier_action.cc(199)] Hash of aop: a/+FDfEjG5fT7d43Lt2kzG+Ij3hWIo9u5anzMHTctRU=</span><br><span class="line">[0119/031118.172903:INFO:filesystem_verifier_action.cc(108)] Hashing partition 18 (modem) on device /dev/block/bootdevice/by-name/modem_b</span><br><span class="line">[0119/031119.258618:INFO:filesystem_verifier_action.cc(199)] Hash of modem: es49VhO5api6iwZjDt/DWLBqXA9DnJvRccmvEL5FK/Y=</span><br><span class="line">[0119/031119.446663:INFO:filesystem_verifier_action.cc(108)] Hashing partition 19 (devcfg) on device /dev/block/bootdevice/by-name/devcfg_b</span><br><span class="line">[0119/031119.449470:INFO:filesystem_verifier_action.cc(199)] Hash of devcfg: CNmqJR7BqkQgcJNdrtCYKCQrJVEgehBfe/eCQGm7/n8=</span><br><span class="line">[0119/031119.449603:INFO:filesystem_verifier_action.cc(108)] Hashing partition 20 (cmnlib64) on device /dev/block/bootdevice/by-name/cmnlib64_b</span><br><span class="line">[0119/031119.455933:INFO:filesystem_verifier_action.cc(199)] Hash of cmnlib64: CTW5va0C8mcZN2pg46xloHvD5tq1x61mHAMGoB7siqM=</span><br><span class="line">[0119/031119.456733:INFO:action_processor.cc(116)] ActionProcessor: finished FilesystemVerifierAction with code ErrorCode::kSuccess</span><br><span class="line">[0119/031119.456762:INFO:action_processor.cc(143)] ActionProcessor: starting PostinstallRunnerAction</span><br><span class="line">gpt_utils_set_xbl_boot_partition: setting /dev/block/bootdevice/by-name/xbl_b lun as boot lun</span><br><span class="line">get_scsi_node_from_bootdevice:scsi generic node is :/dev/sg5:</span><br><span class="line">[0119/031119.489816:INFO:postinstall_runner_action.cc(363)] All post-install commands succeeded</span><br><span class="line">[0119/031119.489859:INFO:action_processor.cc(116)] ActionProcessor: finished last action PostinstallRunnerAction with code ErrorCode::kSuccess</span><br><span class="line">[0119/031119.489883:INFO:update_attempter_android.cc(439)] Processing Done.</span><br><span class="line">[0119/031119.489968:INFO:update_attempter_android.cc(447)] Update successfully applied, waiting to reboot.</span><br><span class="line">[0119/031119.490153:ERROR:prefs.cc(85)] storage_-&gt;DeleteKey(key) failed.</span><br><span class="line">[0119/031119.490176:INFO:metrics_utils.cc(353)] Updated Marker = 1/1/1970 0:23:57 GMT</span><br></pre></td></tr></table></figure>

<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">diff --git a/private/domain.te b/private/domain.te</span></span><br><span class="line"><span class="comment">index 3c1edc1..26bfd2c 100644</span></span><br><span class="line"><span class="comment">--- a/private/domain.te</span></span><br><span class="line"><span class="comment">+++ b/private/domain.te</span></span><br><span class="line"><span class="meta">@@ -312,6 +312,7 @@</span> define(`dac_override_allowed&#x27;, `&#123;</span><br><span class="line">   vold</span><br><span class="line">   vold_prepare_subdirs</span><br><span class="line">   zygote</span><br><span class="line"><span class="addition">+  update_engine</span></span><br><span class="line"> &#125;&#x27;)</span><br><span class="line"> neverallow ~dac_override_allowed self:global_capability_class_set dac_override;</span><br><span class="line"> # Since the kernel checks dac_read_search before dac_override, domains that</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="差量升级ota-log"><a href="#差量升级ota-log" class="headerlink" title="差量升级ota log"></a>差量升级ota log</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br></pre></td><td class="code"><pre><span class="line">08-18 19:24:51.361  1471  1471 I update_engine: [INFO:update_attempter_android.cc(280)] Using this install plan:</span><br><span class="line">08-18 19:24:51.365  1471  1471 I update_engine: [INFO:install_plan.cc(91)] InstallPlan: new_update, version: , source_slot: A, target_slot: B, url: file:///data/ota_package/inc_test.zip, payload: (size: 280875113, metadata_size: 668528, metadata signature: , hash: 60B62E3DD97FB3D966AE7D44B25D7150197D23C3CF28453FC39C8D3FBD94E7DA, payload type: unknown), hash_checks_mandatory: true, powerwash_required: false, switch_slot_on_reboot: true, run_post_install: true, is_rollback: false, write_verity: true</span><br><span class="line">08-18 19:24:51.369  1471  1471 I update_engine: [INFO:metrics_utils.cc(363)] Number of Reboots during current update attempt = 0</span><br><span class="line">08-18 19:24:51.371  1471  1471 I update_engine: [INFO:metrics_utils.cc(371)] Payload Attempt Number = 1</span><br><span class="line">08-18 19:24:51.374  1471  1471 I update_engine: [INFO:metrics_utils.cc(388)] Update Monotonic Timestamp Start = 1/1/1970 0:04:02 GMT</span><br><span class="line">08-18 19:24:51.376  1471  1471 I update_engine: [INFO:metrics_utils.cc(397)] Update Boot Timestamp Start = 1/1/1970 0:04:02 GMT</span><br><span class="line">08-18 19:24:51.378  1471  1471 I update_engine: [INFO:update_attempter_android.cc(648)] Scheduling an action processor start.</span><br><span class="line">08-18 19:24:51.383  1471  1471 I update_engine: [INFO:action_processor.cc(51)] ActionProcessor: starting UpdateBootFlagsAction</span><br><span class="line">08-18 19:24:51.385  1471  1471 I update_engine: [INFO:update_boot_flags_action.cc(45)] Marking booted slot as good.</span><br><span class="line">08-18 19:24:51.412  1471  1471 I update_engine: [INFO:action_processor.cc(116)] ActionProcessor: finished UpdateBootFlagsAction with code ErrorCode::kSuccess</span><br><span class="line">08-18 19:24:51.414  1471  1471 I update_engine: [INFO:action_processor.cc(143)] ActionProcessor: starting CleanupPreviousUpdateAction</span><br><span class="line">08-18 19:24:51.416  1471  1471 I update_engine: [INFO:cleanup_previous_update_action.cc(82)] Starting/resuming CleanupPreviousUpdateAction</span><br><span class="line">08-18 19:24:51.417  1471  1471 I update_engine: [INFO:cleanup_previous_update_action.cc(137)] Boot completed, waiting on markBootSuccessful()</span><br><span class="line">08-18 19:24:51.420  1471  1471 I update_engine: EnsureMetadataMounted does nothing in Android mode.</span><br><span class="line">08-18 19:24:51.422  1471  1471 I update_engine: Read merge statistics file failed: No such file or directory</span><br><span class="line">08-18 19:24:51.424  1471  1471 I update_engine: [INFO:cleanup_previous_update_action.cc(206)] Waiting for any previous merge request to complete. This can take up to several minutes.</span><br><span class="line">08-18 19:24:51.426  1471  1471 E update_engine: [ERROR:cleanup_previous_update_action.cc(240)] Previous update has not been completed, not cleaning up</span><br><span class="line">08-18 19:24:51.428  1471  1471 I update_engine: [INFO:cleanup_previous_update_action.cc(397)] Not reporting merge stats because state is Initiated</span><br><span class="line">08-18 19:24:51.429  1471  1471 I update_engine: [INFO:action_processor.cc(116)] ActionProcessor: finished CleanupPreviousUpdateAction with code ErrorCode::kSuccess</span><br><span class="line">08-18 19:24:51.431  1471  1471 I update_engine: [INFO:action_processor.cc(143)] ActionProcessor: starting InstallPlanAction</span><br><span class="line">08-18 19:24:51.433  1471  1471 I update_engine: [INFO:action_processor.cc(116)] ActionProcessor: finished InstallPlanAction with code ErrorCode::kSuccess</span><br><span class="line">08-18 19:24:51.435  1471  1471 I update_engine: [INFO:action_processor.cc(143)] ActionProcessor: starting DownloadAction</span><br><span class="line">08-18 19:24:51.437  1471  1471 I update_engine: [INFO:install_plan.cc(91)] InstallPlan: new_update, version: , source_slot: A, target_slot: B, url: file:///data/ota_package/inc_test.zip, payload: (size: 280875113, metadata_size: 668528, metadata signature: , hash: 60B62E3DD97FB3D966AE7D44B25D7150197D23C3CF28453FC39C8D3FBD94E7DA, payload type: unknown), hash_checks_mandatory: true, powerwash_required: false, switch_slot_on_reboot: true, run_post_install: true, is_rollback: false, write_verity: true</span><br><span class="line">08-18 19:24:51.438  1471  1471 I update_engine: [INFO:download_action.cc(199)] Marking new slot as unbootable</span><br><span class="line">08-18 19:24:51.460  1471  1471 I update_engine: [INFO:multi_range_http_fetcher.cc(45)] starting first transfer</span><br><span class="line">08-18 19:24:51.463  1471  1471 I update_engine: [INFO:multi_range_http_fetcher.cc(74)] starting transfer of range 1427+280875113</span><br><span class="line">08-18 19:24:51.468  1471  1471 I update_engine: [INFO:delta_performer.cc(209)] Completed 0/? operations, 16384/280875113 bytes downloaded (0%), overall progress 0%</span><br><span class="line">08-18 19:24:51.500  1471  1471 I update_engine: [INFO:delta_performer.cc(520)] Manifest size in payload matches expected value from Omaha</span><br><span class="line">08-18 19:24:51.502  1471  1471 I update_engine: [INFO:delta_performer.cc(1693)] Verifying using certificates: /system/etc/security/otacerts.zip</span><br><span class="line">08-18 19:24:51.508  1471  1471 I update_engine: [INFO:payload_verifier.cc(102)] signature blob size = 267</span><br><span class="line">08-18 19:24:51.510  1471  1471 I update_engine: [INFO:payload_verifier.cc(118)] Truncating the signature to its unpadded size: 256.</span><br><span class="line">08-18 19:24:51.512  1471  1471 I update_engine: [INFO:payload_verifier.cc(129)] Verified correct signature 1 out of 1 signatures.</span><br><span class="line">08-18 19:24:51.514  1471  1471 I update_engine: [INFO:payload_metadata.cc(224)] Metadata hash signature matches value in Omaha response.</span><br><span class="line">08-18 19:24:51.551  1471  1471 I update_engine: [INFO:delta_performer.cc(1728)] Detected a &#x27;delta&#x27; payload.</span><br><span class="line">08-18 19:24:51.575  1471  1471 I update_engine: [INFO:prefs.cc(122)] dynamic-partition-metadata-updated not present in /data/misc/update_engine/prefs</span><br><span class="line">08-18 19:24:51.580  1471  1471 I update_engine: [INFO:delta_performer.cc(985)] Preparing partitions for new update. last hash = , new hash = YLYuPdl/s9lmrn1Esl1xUBl9I8PPKEU/w5yNP72U59o=cwT0tXBzdXay7seGtMnnLLggDWo8d2VvGTwG3+iAGQA=</span><br><span class="line">08-18 19:24:51.586  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:51.590  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:51.607  1471  1471 I update_engine: type=1400 audit(0.0:1346): avc: denied &#123; search &#125; for name=&quot;/&quot; dev=&quot;sde6&quot; ino=1 scontext=u:r:update_engine:s0 tcontext=u:object_r:bt_firmware_file:s0 tclass=dir permissive=1</span><br><span class="line">08-18 19:24:51.611  1471  1471 I update_engine: EnsureMetadataMounted does nothing in Android mode.</span><br><span class="line">08-18 19:24:51.615  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(676)] Erasing AVB footer of system_other partition before update.</span><br><span class="line">08-18 19:24:51.619  1471  1471 E update_engine: [libfs_mgr]ReadFstabFromFile(): cannot open file: &#x27;/system/etc/fstab.postinstall&#x27;: No such file or directory</span><br><span class="line">08-18 19:24:51.621  1471  1471 W update_engine: [WARNING:dynamic_partition_control_android.cc(550)] Cannot read fstab from /system/etc/fstab.postinstall: No such file or directory (2)</span><br><span class="line">08-18 19:24:51.623  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(577)] AVB is not enabled on system_other. Skip erasing.</span><br><span class="line">08-18 19:24:51.625  1471  1471 I update_engine: Update has been initiated, now canceling</span><br><span class="line">08-18 19:24:51.627  1471  1471 I update_engine: Removing all update state.</span><br><span class="line">08-18 19:24:51.629  1471  1471 W update_engine: Cannot read /metadata/ota/snapshot-boot: No such file or directory</span><br><span class="line">08-18 19:24:51.630  1471  1471 W update_engine: Failed to get flashing status</span><br><span class="line">08-18 19:24:51.632  1471  1471 W update_engine: Cannot read /metadata/ota/snapshot-boot: No such file or directory</span><br><span class="line">08-18 19:24:52.644  1471  1471 I update_engine: Successfully unmapped snapshot system_b</span><br><span class="line">08-18 19:24:52.654  1471  1471 I update_engine: Successfully unmapped snapshot vendor_b</span><br><span class="line">08-18 19:24:52.766  1471  1471 I update_engine: Successfully unmapped snapshot product_b</span><br><span class="line">08-18 19:24:52.776  1471  1471 I update_engine: Successfully unmapped snapshot odm_b</span><br><span class="line">08-18 19:24:52.837  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:52.858  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:52.883  1471  1471 I update_engine: [liblp]Partition odm_b will resize from 1286144 bytes to 1089536 bytes</span><br><span class="line">08-18 19:24:52.885  1471  1471 I update_engine: [liblp]Partition system_b will resize from 3553296384 bytes to 3517079552 bytes</span><br><span class="line">08-18 19:24:52.886  1471  1471 I update_engine: [liblp]Partition product_b will resize from 310919168 bytes to 328949760 bytes</span><br><span class="line">08-18 19:24:52.888  1471  1471 I update_engine: [liblp]Partition vendor_b will resize from 1469992960 bytes to 1523589120 bytes</span><br><span class="line">08-18 19:24:52.889  1471  1471 I update_engine: Remaining free space for COW: 3753377792 bytes</span><br><span class="line">08-18 19:24:52.934  1471  1471 I update_engine: For partition system_b, device size = 3517079552, snapshot size = 3517079552, cow partition size = 3530821632, cow file size = 0</span><br><span class="line">08-18 19:24:52.941  1471  1471 I update_engine: [liblp]Partition system_b-cow will resize from 0 bytes to 3530821632 bytes</span><br><span class="line">08-18 19:24:52.943  1471  1471 I update_engine: Successfully created snapshot partition for system_b</span><br><span class="line">08-18 19:24:52.945  1471  1471 I update_engine: Remaining free space for COW: 222298112 bytes</span><br><span class="line">08-18 19:24:52.951  1471  1471 I update_engine: For partition product_b, device size = 328949760, snapshot size = 328949760, cow partition size = 222298112, cow file size = 107937792</span><br><span class="line">08-18 19:24:52.954  1471  1471 I update_engine: [liblp]Partition product_b-cow will resize from 0 bytes to 222298112 bytes</span><br><span class="line">08-18 19:24:52.956  1471  1471 I update_engine: Successfully created snapshot partition for product_b</span><br><span class="line">08-18 19:24:52.958  1471  1471 I update_engine: Remaining free space for COW: 0 bytes</span><br><span class="line">08-18 19:24:52.976  1471  1471 I update_engine: For partition vendor_b, device size = 1523589120, snapshot size = 1523589120, cow partition size = 0, cow file size = 1529540608</span><br><span class="line">08-18 19:24:52.982  1471  1471 I update_engine: Successfully created snapshot partition for vendor_b</span><br><span class="line">08-18 19:24:52.986  1471  1471 I update_engine: Remaining free space for COW: 0 bytes</span><br><span class="line">08-18 19:24:52.988  1471  1471 I update_engine: For partition odm_b, device size = 1089536, snapshot size = 1089536, cow partition size = 0, cow file size = 1044480</span><br><span class="line">08-18 19:24:52.990  1471  1471 I update_engine: Successfully created snapshot partition for odm_b</span><br><span class="line">08-18 19:24:52.992  1471  1471 I update_engine: Allocating CoW images.</span><br><span class="line">08-18 19:24:53.006  1471  1471 I update_engine: Successfully created snapshot for odm_b</span><br><span class="line">08-18 19:24:53.104  1471  1471 I update_engine: Successfully created snapshot for product_b</span><br><span class="line">08-18 19:24:53.126  1471  1471 I update_engine: Successfully created snapshot for system_b</span><br><span class="line">08-18 19:24:53.621  1471  1471 I update_engine: Successfully created snapshot for vendor_b</span><br><span class="line">08-18 19:24:53.625  1471  1471 I update_engine: Successfully unmapped snapshot system_b</span><br><span class="line">08-18 19:24:53.661  1471  1471 I update_engine: Mapped COW device for system_b at /dev/block/dm-9</span><br><span class="line">08-18 19:24:53.666  1471  1471 I update_engine: Zero-filling COW device: /dev/block/dm-9</span><br><span class="line">08-18 19:24:53.708  1471  1471 I update_engine: Successfully unmapped snapshot product_b</span><br><span class="line">08-18 19:24:53.740  1471  1471 I update_engine: Mapped product_b-cow-img to /dev/block/dm-9</span><br><span class="line">08-18 19:24:53.769  1471  1471 I update_engine: Mapped COW device for product_b at /dev/block/dm-10</span><br><span class="line">08-18 19:24:53.775  1471  1471 I update_engine: Zero-filling COW device: /dev/block/dm-10</span><br><span class="line">08-18 19:24:53.835  1471  1471 I update_engine: Successfully unmapped snapshot vendor_b</span><br><span class="line">08-18 19:24:53.862  1471  1471 I update_engine: Mapped vendor_b-cow-img to /dev/block/dm-9</span><br><span class="line">08-18 19:24:53.865  1471  1471 I update_engine: Mapped COW image for vendor_b at vendor_b-cow-img</span><br><span class="line">08-18 19:24:53.868  1471  1471 I update_engine: Zero-filling COW device: /dev/block/dm-9</span><br><span class="line">08-18 19:24:53.900  1471  1471 I update_engine: Successfully unmapped snapshot odm_b</span><br><span class="line">08-18 19:24:53.930  1471  1471 I update_engine: Mapped odm_b-cow-img to /dev/block/dm-9</span><br><span class="line">08-18 19:24:53.933  1471  1471 I update_engine: Mapped COW image for odm_b at odm_b-cow-img</span><br><span class="line">08-18 19:24:53.935  1471  1471 I update_engine: Zero-filling COW device: /dev/block/dm-9</span><br><span class="line">08-18 19:24:53.968  1471  1471 I update_engine: [liblp]Updated logical partition table at slot 1 on device super</span><br><span class="line">08-18 19:24:53.970  1471  1471 I update_engine: Successfully created all snapshots for target slot _b</span><br><span class="line">08-18 19:24:53.973  1471  1471 I update_engine: [INFO:delta_performer.cc(1002)] PreparePartitionsForUpdate done.</span><br><span class="line">08-18 19:24:53.999  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.002  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.004  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.006  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] abl_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.008  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.011  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.013  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.016  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.018  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] abl_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.020  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.022  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.025  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.027  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.029  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] aop_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.031  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.033  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.035  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.038  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.039  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] aop_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.041  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.043  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.045  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.048  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.049  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] bluetooth_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.051  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.053  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.056  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.059  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.060  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] bluetooth_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.062  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.064  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.067  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.069  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.071  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] boot_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.072  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.075  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.077  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.079  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.081  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] boot_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.083  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.085  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.088  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.090  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.091  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] cpucp_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.094  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.096  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.098  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.100  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.102  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] cpucp_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.104  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.107  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.109  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.111  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.113  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] devcfg_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.115  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.117  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.119  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.121  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.122  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] devcfg_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.125  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.127  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.129  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.131  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.133  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] dsp_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.135  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.137  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.139  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.142  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.144  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] dsp_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.146  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.148  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.150  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.152  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.154  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] dtbo_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.156  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.158  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.161  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.163  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.164  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] dtbo_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.166  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.169  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.171  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.174  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.175  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] featenabler_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.177  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.179  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.182  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.184  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.185  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] featenabler_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.188  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.190  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.193  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.195  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.197  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] hyp_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.200  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.202  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.205  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.208  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.210  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] hyp_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.212  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.214  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.217  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.220  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.221  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] imagefv_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.224  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.226  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.229  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.231  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.233  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] imagefv_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.235  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.238  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.241  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.243  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.244  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] keymaster_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.246  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.249  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.251  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.253  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.255  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] keymaster_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.257  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.259  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.262  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.264  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.265  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] modem_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.267  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.269  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.272  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.274  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.276  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] modem_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.278  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.280  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.282  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.285  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.286  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(957)] odm_a is mapped on device mapper: /dev/block/dm-3</span><br><span class="line">08-18 19:24:54.288  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.291  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.293  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.295  1471  1471 I update_engine: Successfully unmapped snapshot odm_b</span><br><span class="line">08-18 19:24:54.328  1471  1471 I update_engine: [libfs_mgr]Created logical partition odm_b-base on device /dev/block/dm-9</span><br><span class="line">08-18 19:24:54.358  1471  1471 I update_engine: Mapped odm_b-cow-img to /dev/block/dm-10</span><br><span class="line">08-18 19:24:54.361  1471  1471 I update_engine: Mapped COW image for odm_b at odm_b-cow-img</span><br><span class="line">08-18 19:24:54.420  1471  1471 I update_engine: Mapped odm_b as snapshot device at /dev/block/dm-11</span><br><span class="line">08-18 19:24:54.422  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(173)] Succesfully mapped odm_b to device mapper (force_writable = 1); device path at /dev/block/dm-11</span><br><span class="line">08-18 19:24:54.426  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.429  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.432  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.433  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(957)] product_a is mapped on device mapper: /dev/block/dm-1</span><br><span class="line">08-18 19:24:54.435  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.438  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.440  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.441  1471  1471 I update_engine: Successfully unmapped snapshot product_b</span><br><span class="line">08-18 19:24:54.472  1471  1471 I update_engine: [libfs_mgr]Created logical partition product_b-base on device /dev/block/dm-12</span><br><span class="line">08-18 19:24:54.503  1471  1471 I update_engine: Mapped product_b-cow-img to /dev/block/dm-13</span><br><span class="line">08-18 19:24:54.536  1471  1471 I update_engine: Mapped COW device for product_b at /dev/block/dm-14</span><br><span class="line">08-18 19:24:54.557  1471  1471 I update_engine: Mapped product_b as snapshot device at /dev/block/dm-15</span><br><span class="line">08-18 19:24:54.561  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(173)] Succesfully mapped product_b to device mapper (force_writable = 1); device path at /dev/block/dm-15</span><br><span class="line">08-18 19:24:54.564  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.567  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.569  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.571  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] qupfw_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.573  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.576  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.579  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.582  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.584  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] qupfw_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.586  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.588  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.591  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.593  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.595  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] shrm_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.597  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.599  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.602  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.604  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.605  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] shrm_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.607  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.610  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.612  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.614  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.616  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(957)] system_a is mapped on device mapper: /dev/block/dm-0</span><br><span class="line">08-18 19:24:54.618  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.621  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.623  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.625  1471  1471 I update_engine: Successfully unmapped snapshot system_b</span><br><span class="line">08-18 19:24:54.656  1471  1471 I update_engine: [libfs_mgr]Created logical partition system_b-base on device /dev/block/dm-16</span><br><span class="line">08-18 19:24:54.691  1471  1471 I update_engine: Mapped COW device for system_b at /dev/block/dm-17</span><br><span class="line">08-18 19:24:54.712  1471  1471 I update_engine: Mapped system_b as snapshot device at /dev/block/dm-18</span><br><span class="line">08-18 19:24:54.715  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(173)] Succesfully mapped system_b to device mapper (force_writable = 1); device path at /dev/block/dm-18</span><br><span class="line">08-18 19:24:54.718  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.721  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.724  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.726  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] tz_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.728  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.730  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.733  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.735  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.737  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] tz_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.739  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.742  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.744  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.746  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.748  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] uefisecapp_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.750  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.752  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.755  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.757  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.759  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] uefisecapp_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.761  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.764  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.767  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.769  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.771  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] vbmeta_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.773  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.775  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.778  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.780  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.782  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] vbmeta_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.784  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.786  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.789  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.792  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.793  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] vbmeta_system_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.796  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.798  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.801  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.804  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.806  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] vbmeta_system_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.808  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.811  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.814  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.817  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.819  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(957)] vendor_a is mapped on device mapper: /dev/block/dm-2</span><br><span class="line">08-18 19:24:54.821  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.824  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.826  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.828  1471  1471 I update_engine: Successfully unmapped snapshot vendor_b</span><br><span class="line">08-18 19:24:54.861  1471  1471 I update_engine: [libfs_mgr]Created logical partition vendor_b-base on device /dev/block/dm-19</span><br><span class="line">08-18 19:24:54.889  1471  1471 I update_engine: Mapped vendor_b-cow-img to /dev/block/dm-20</span><br><span class="line">08-18 19:24:54.893  1471  1471 I update_engine: Mapped COW image for vendor_b at vendor_b-cow-img</span><br><span class="line">08-18 19:24:54.913  1471  1471 I update_engine: Mapped vendor_b as snapshot device at /dev/block/dm-21</span><br><span class="line">08-18 19:24:54.920  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(173)] Succesfully mapped vendor_b to device mapper (force_writable = 1); device path at /dev/block/dm-21</span><br><span class="line">08-18 19:24:54.924  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.927  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.930  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.932  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] vendor_boot_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.935  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.938  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.941  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.944  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.946  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] vendor_boot_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.948  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.950  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.953  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.955  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.957  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] vm-bootsys_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.959  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.962  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.965  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.967  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.969  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] vm-bootsys_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.972  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.974  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.977  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.979  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.981  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] xbl_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.983  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.985  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.988  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:54.990  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.992  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] xbl_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:54.994  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:54.996  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:54.999  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:55.001  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:55.003  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] xbl_config_a is not in super partition metadata.</span><br><span class="line">08-18 19:24:55.005  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:55.007  1471  1471 I update_engine: [libfs_mgr]dt_fstab: Skip disabled entry for partition vendor</span><br><span class="line">08-18 19:24:55.010  1471  1471 I update_engine: Skip mounting partition: /system_ext</span><br><span class="line">08-18 19:24:55.013  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot B in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:55.015  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(938)] xbl_config_b is not in super partition metadata.</span><br><span class="line">08-18 19:24:55.017  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(319)] Loaded metadata from slot A in /dev/block/bootdevice/by-name/super</span><br><span class="line">08-18 19:24:55.019  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old abl sha256: LKUfY1q5mz+KuU4Rmg+MrNqlzBahrYzBU4kOiE8Ooj8= size: 208896</span><br><span class="line">08-18 19:24:55.021  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new abl sha256: hS8rXeEII9MtiJhBaUCxxPfQOUUPeyrxsAU4NxmRr5E= size: 208896</span><br><span class="line">08-18 19:24:55.023  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old aop sha256: +xi8aAv0b4LPhA7kt/VRZ4AqEFxl2IkVj9bOULKDU/M= size: 237568</span><br><span class="line">08-18 19:24:55.025  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new aop sha256: e9o49HW8O1Fu5AwhkPiNrF3tF3vDjG4Ae0RIyoFdXM0= size: 241664</span><br><span class="line">08-18 19:24:55.027  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old bluetooth sha256: c+6BjIunasEsCvK6Jr5m7BzCGJq3tyDHhL3pvQkqVgI= size: 880640</span><br><span class="line">08-18 19:24:55.029  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new bluetooth sha256: zgQ+DFP0LI3nyFOPLQsHE0ZiWrWhaf6+kqmXXBOtIYs= size: 880640</span><br><span class="line">08-18 19:24:55.030  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old boot sha256: i8WwddePQv4qv2Jgtu06Mc5KUAfliUZOJfuzeVROKZU= size: 201326592</span><br><span class="line">08-18 19:24:55.032  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new boot sha256: BCPYki46J+9B7L2Qw0dyqjT4tIgs32GNWP9LPXsB67c= size: 201326592</span><br><span class="line">08-18 19:24:55.034  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old cpucp sha256: Iopy3jwBtH34WvG7QE8hV1VjUptSy6ZdNcqGR0bwPLw= size: 94208</span><br><span class="line">08-18 19:24:55.035  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new cpucp sha256: uaQ7Vd67d7OZbqQijAqsMi8EUJr92PkfPWRCXRY8A3I= size: 98304</span><br><span class="line">08-18 19:24:55.037  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old devcfg sha256: R3UrDvSUGAYyk6z6AGSr6NJ1jv2m1J4ED79aXIyrlhA= size: 49152</span><br><span class="line">08-18 19:24:55.039  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new devcfg sha256: XEZTYY+qC/x3ReEZoJworSGR4/46+PrVrPwSDSslv00= size: 53248</span><br><span class="line">08-18 19:24:55.040  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old dsp sha256: suWGN67jBTosAj9AnqkLIMWJ1ltQ23+u2m907aThq6I= size: 67108864</span><br><span class="line">08-18 19:24:55.042  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new dsp sha256: suWGN67jBTosAj9AnqkLIMWJ1ltQ23+u2m907aThq6I= size: 67108864</span><br><span class="line">08-18 19:24:55.043  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old dtbo sha256: 8pO250Kv+c0lantXJRsH5nuyJIldedl4TZ3DSgjqsgs= size: 8388608</span><br><span class="line">08-18 19:24:55.045  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new dtbo sha256: z9EcMQ0GeM/EUjGJufNOyezldChHx9F9YygkgMdMbKI= size: 8388608</span><br><span class="line">08-18 19:24:55.046  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old featenabler sha256: lG3p43ZOZvarWcTxWX8EE4SFMnxpjL3GsnfjBSOxrWc= size: 86016</span><br><span class="line">08-18 19:24:55.048  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new featenabler sha256: IhmZnJ3dWkolqEJy41s5We3Cr0tQIiXZPWTKmBBirBc= size: 90112</span><br><span class="line">08-18 19:24:55.050  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old hyp sha256: 85Xh+KcpkrrqsHRsagKvIAPrsOONgz/4Dnb4bzpRZ8k= size: 3395584</span><br><span class="line">08-18 19:24:55.051  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new hyp sha256: ywlIjYFGmFdsPZwFBCZ0opfEvdERJzGPzDrGzVlWWZ8= size: 3399680</span><br><span class="line">08-18 19:24:55.053  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old imagefv sha256: Km9PNGzyje+WR5TLaZk3129bHLCuz2cJJ8g+cKe+6Qk= size: 28672</span><br><span class="line">08-18 19:24:55.055  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new imagefv sha256: /2kScNnnNSZXg4v4siLy2+Aew4Y4XzrJUaJSWzULYeA= size: 28672</span><br><span class="line">08-18 19:24:55.056  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old keymaster sha256: 4KHtQoMQb5u7nRY3HiIOk5TOcQuowNNHzIqgLIOjpzU= size: 258048</span><br><span class="line">08-18 19:24:55.058  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new keymaster sha256: MA6O6lkgd8OUfaIdudxGnfYDL2x8hzmakyZHi0Rkvag= size: 262144</span><br><span class="line">08-18 19:24:55.059  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old modem sha256: ko9BWvXMob/IoCy8A+uvq6GwVeBDwswUlqNIAhLaWZY= size: 192884736</span><br><span class="line">08-18 19:24:55.061  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new modem sha256: z9drl26xsoafKek/73PdmdczM5bJOw1X4zRVCvL9Mog= size: 193671168</span><br><span class="line">08-18 19:24:55.062  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old odm sha256: 2Y1fxITkZW1c4hFYBgC7RyAX2dAzHJtnV7ELApEMSCE= size: 1286144</span><br><span class="line">08-18 19:24:55.064  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new odm sha256: l/oIDspqyiDykR4mjk2GPh6zmheHo5f03U9XI1Dfzyg= size: 1089536</span><br><span class="line">08-18 19:24:55.065  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old product sha256: rBOR7K0r7PjpLCPkZI585l0ru8YFtd58Uia9td+7WTY= size: 310919168</span><br><span class="line">08-18 19:24:55.067  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new product sha256: 6TYZ3vLg5bXchP2xAAp3dZrK9r7pY2rbjyD6G+sjk8Y= size: 328949760</span><br><span class="line">08-18 19:24:55.069  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old qupfw sha256: tTsWZkkP/F9TZZ+uWYwLLb7frJ3H/y5XJbxvQmUjIqg= size: 53248</span><br><span class="line">08-18 19:24:55.070  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new qupfw sha256: 3jpnlnLyamrF6hrpPoJ+nOl5tIXKKqbDaOtL1+rgu3s= size: 57344</span><br><span class="line">08-18 19:24:55.072  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old shrm sha256: KrVggLqd3q6VS4C33hRMfWs9vnJX0r+LI23bKLWZ+2E= size: 40960</span><br><span class="line">08-18 19:24:55.073  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new shrm sha256: OYFDe2zcvXDWyPGIyEPOCvtFa9z9MxJ3kro2VzQLWPI= size: 45056</span><br><span class="line">08-18 19:24:55.075  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old system sha256: LhRpM2Co250bUcefZesGxf9sWsi4Iv4GmwLW+gi10EI= size: 3553296384</span><br><span class="line">08-18 19:24:55.076  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new system sha256: cd3Ps088SC1Pe+STTyQvVrK8+cmLLpoCvQlHBle7/io= size: 3517079552</span><br><span class="line">08-18 19:24:55.078  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old tz sha256: 7eBsfC6w41AYS3xI6L0IM78LWLzakupzq0pCPIKVf6s= size: 3624960</span><br><span class="line">08-18 19:24:55.080  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new tz sha256: XJ0GRq1SOmNjs+wlCaH23g6BnYsArLmtRTno9F8B3Aw= size: 3629056</span><br><span class="line">08-18 19:24:55.081  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old uefisecapp sha256: Rw22/udqIRoIpmnH8XXmXXgTIVkRBgSZ+EBf1S/vfPs= size: 122880</span><br><span class="line">08-18 19:24:55.083  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new uefisecapp sha256: Fz8/c9AKTBw0mU48AHyVN8EFPLZdBt6On5w6+giUOXU= size: 126976</span><br><span class="line">08-18 19:24:55.085  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old vbmeta sha256: +1lHFFhEHNNXkoGzV+UepcA2ACn52gpr4wcZIFjK3Os= size: 8192</span><br><span class="line">08-18 19:24:55.086  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new vbmeta sha256: TgLJLUIKbeSmTd5XCQnyDJKiuQCh32sV2acdW3+V8xc= size: 8192</span><br><span class="line">08-18 19:24:55.088  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old vbmeta_system sha256: oCfE/MmDj/oFNutvF8323jQmMOUSZyxWZ967xwIyP/M= size: 4096</span><br><span class="line">08-18 19:24:55.090  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new vbmeta_system sha256: 9iscNy39AWU0lXaikuLtSmFQtSqgudkmYhfotwiEHHQ= size: 4096</span><br><span class="line">08-18 19:24:55.091  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old vendor sha256: Bnecgyti7gGs/uXInom7bpl3PUJ8bpAGJqL9OTMWUWs= size: 1469992960</span><br><span class="line">08-18 19:24:55.093  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new vendor sha256: KbMKhjjPPUb6ew38BtauoenktJzeXsAyIAQo1Suj+pI= size: 1523589120</span><br><span class="line">08-18 19:24:55.094  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old vendor_boot sha256: DLiSM4l+ydJE9BAY1xn5W6PD4fnAdGrNx83GwTszUVI= size: 100663296</span><br><span class="line">08-18 19:24:55.096  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new vendor_boot sha256: TZ8xsevkXAMLUAoliRXRrS5V2KXwgz+12bSKqSDH8oM= size: 100663296</span><br><span class="line">08-18 19:24:55.097  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old vm-bootsys sha256: eLgXQJ1Qc8shx8H2kpN7i9S7enKAPXcIyf7dB6Dnh9E= size: 229998592</span><br><span class="line">08-18 19:24:55.099  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new vm-bootsys sha256: PvhkY00YGb0Pz8F/NW3NR9KCkULkaMGlv5pPd2pjAlM= size: 229998592</span><br><span class="line">08-18 19:24:55.101  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old xbl sha256: 8s3zMMejgPFQVTda+PL8/oMWZ8TuQI+iANRg/uci02c= size: 3637248</span><br><span class="line">08-18 19:24:55.102  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new xbl sha256: X6ni5/bFuI4xVs0pX4b7Nnp/76s0p6vc03t8pa1+WLc= size: 3641344</span><br><span class="line">08-18 19:24:55.104  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo old xbl_config sha256: WxnRMP2xzZxmwabirIbkVhcC4Sq1V83/JwoB5kRwWsY= size: 212992</span><br><span class="line">08-18 19:24:55.105  1471  1471 I update_engine: [INFO:delta_performer.cc(451)] PartitionInfo new xbl_config sha256: 62UgiqGTFSnz9HN2uM6fwh0vkU91uTbK3xzmHAOizt0= size: 217088</span><br><span class="line">08-18 19:24:55.107  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/bootdevice/by-name/abl_b partition without O_DSYNC</span><br><span class="line">08-18 19:24:55.112  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:24:55.114  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 5 operations to partition &quot;abl&quot;</span><br><span class="line">08-18 19:24:55.116  1471  1471 I update_engine: [INFO:delta_performer.cc(657)] Starting to apply update payload operations</span><br><span class="line">08-18 19:24:55.159  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/bootdevice/by-name/aop_b partition without O_DSYNC</span><br><span class="line">08-18 19:24:55.164  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:24:55.167  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 9 operations to partition &quot;aop&quot;</span><br><span class="line">08-18 19:24:55.225  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/bootdevice/by-name/bluetooth_b partition without O_DSYNC</span><br><span class="line">08-18 19:24:55.230  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:24:55.233  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 90 operations to partition &quot;bluetooth&quot;</span><br><span class="line">08-18 19:24:55.509  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/bootdevice/by-name/boot_b partition without O_DSYNC</span><br><span class="line">08-18 19:24:55.514  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:24:55.516  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 115 operations to partition &quot;boot&quot;</span><br><span class="line">08-18 19:24:58.794  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/bootdevice/by-name/cpucp_b partition without O_DSYNC</span><br><span class="line">08-18 19:24:58.799  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:24:58.801  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 3 operations to partition &quot;cpucp&quot;</span><br><span class="line">08-18 19:24:58.828  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/bootdevice/by-name/devcfg_b partition without O_DSYNC</span><br><span class="line">08-18 19:24:58.833  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:24:58.835  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 5 operations to partition &quot;devcfg&quot;</span><br><span class="line">08-18 19:24:58.872  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/bootdevice/by-name/dsp_b partition without O_DSYNC</span><br><span class="line">08-18 19:24:58.877  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:24:58.879  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 62 operations to partition &quot;dsp&quot;</span><br><span class="line">08-18 19:24:59.368  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/bootdevice/by-name/dtbo_b partition without O_DSYNC</span><br><span class="line">08-18 19:24:59.374  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:24:59.376  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 4 operations to partition &quot;dtbo&quot;</span><br><span class="line">08-18 19:24:59.436  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/bootdevice/by-name/featenabler_b partition without O_DSYNC</span><br><span class="line">08-18 19:24:59.441  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:24:59.444  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 3 operations to partition &quot;featenabler&quot;</span><br><span class="line">08-18 19:24:59.467  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/bootdevice/by-name/hyp_b partition without O_DSYNC</span><br><span class="line">08-18 19:24:59.471  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:24:59.473  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 7 operations to partition &quot;hyp&quot;</span><br><span class="line">08-18 19:24:59.598  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/bootdevice/by-name/imagefv_b partition without O_DSYNC</span><br><span class="line">08-18 19:24:59.603  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:24:59.605  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 3 operations to partition &quot;imagefv&quot;</span><br><span class="line">08-18 19:24:59.631  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/bootdevice/by-name/keymaster_b partition without O_DSYNC</span><br><span class="line">08-18 19:24:59.636  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:24:59.639  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 3 operations to partition &quot;keymaster&quot;</span><br><span class="line">08-18 19:24:59.669  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/bootdevice/by-name/modem_b partition without O_DSYNC</span><br><span class="line">08-18 19:24:59.673  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:24:59.675  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 2307 operations to partition &quot;modem&quot;</span><br><span class="line">08-18 19:25:00.036  1471  1471 I update_engine: [INFO:delta_performer.cc(209)] Completed 310/10273 operations (3%), 50561024/280875113 bytes downloaded (18%), overall progress 10%</span><br><span class="line">08-18 19:25:06.425  1471  1471 I update_engine: [INFO:delta_performer.cc(209)] Completed 2261/10273 operations (22%), 53575680/280875113 bytes downloaded (19%), overall progress 20%</span><br><span class="line">08-18 19:25:07.544  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/dm-11 partition without O_DSYNC</span><br><span class="line">08-18 19:25:07.551  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:25:07.553  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 10 operations to partition &quot;odm&quot;</span><br><span class="line">08-18 19:25:07.654  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/dm-15 partition without O_DSYNC</span><br><span class="line">08-18 19:25:07.659  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:25:07.662  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 280 operations to partition &quot;product&quot;</span><br><span class="line">08-18 19:25:14.019  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/bootdevice/by-name/qupfw_b partition without O_DSYNC</span><br><span class="line">08-18 19:25:14.025  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:25:14.028  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 3 operations to partition &quot;qupfw&quot;</span><br><span class="line">08-18 19:25:14.049  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/bootdevice/by-name/shrm_b partition without O_DSYNC</span><br><span class="line">08-18 19:25:14.054  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:25:14.056  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 3 operations to partition &quot;shrm&quot;</span><br><span class="line">08-18 19:25:14.099  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/dm-18 partition without O_DSYNC</span><br><span class="line">08-18 19:25:14.103  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:25:14.106  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 4847 operations to partition &quot;system&quot;</span><br><span class="line">08-18 19:25:19.109  1471  1471 I update_engine: [INFO:delta_performer.cc(209)] Completed 3493/10273 operations (34%), 76431360/280875113 bytes downloaded (27%), overall progress 30%</span><br><span class="line">08-18 19:25:34.556  1471  1471 I update_engine: [INFO:delta_performer.cc(209)] Completed 4449/10273 operations (43%), 106741760/280875113 bytes downloaded (38%), overall progress 40%</span><br><span class="line">08-18 19:25:40.412  1471  1471 I update_engine: [INFO:delta_performer.cc(209)] Completed 4490/10273 operations (43%), 162922496/280875113 bytes downloaded (58%), overall progress 50%</span><br><span class="line">08-18 19:25:52.807  1471  1471 I update_engine: [INFO:delta_performer.cc(209)] Completed 5548/10273 operations (54%), 187367424/280875113 bytes downloaded (66%), overall progress 60%</span><br><span class="line">08-18 19:26:01.516  1471  1471 I update_engine: [INFO:delta_performer.cc(209)] Completed 6275/10273 operations (61%), 224706560/280875113 bytes downloaded (80%), overall progress 70%</span><br><span class="line">08-18 19:26:16.267  1471  1471 I update_engine: [INFO:delta_performer.cc(209)] Completed 7603/10273 operations (74%), 244678656/280875113 bytes downloaded (87%), overall progress 80%</span><br><span class="line">08-18 19:26:20.298  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/bootdevice/by-name/tz_b partition without O_DSYNC</span><br><span class="line">08-18 19:26:20.305  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:26:20.307  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 29 operations to partition &quot;tz&quot;</span><br><span class="line">08-18 19:26:20.444  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/bootdevice/by-name/uefisecapp_b partition without O_DSYNC</span><br><span class="line">08-18 19:26:20.450  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:26:20.452  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 5 operations to partition &quot;uefisecapp&quot;</span><br><span class="line">08-18 19:26:20.486  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/bootdevice/by-name/vbmeta_b partition without O_DSYNC</span><br><span class="line">08-18 19:26:20.491  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:26:20.493  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 1 operations to partition &quot;vbmeta&quot;</span><br><span class="line">08-18 19:26:20.506  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/bootdevice/by-name/vbmeta_system_b partition without O_DSYNC</span><br><span class="line">08-18 19:26:20.510  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:26:20.512  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 1 operations to partition &quot;vbmeta_system&quot;</span><br><span class="line">08-18 19:26:20.527  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/dm-21 partition without O_DSYNC</span><br><span class="line">08-18 19:26:20.531  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:26:20.533  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 1853 operations to partition &quot;vendor&quot;</span><br><span class="line">08-18 19:26:34.562  1471  1471 I update_engine: [INFO:delta_performer.cc(209)] Completed 9041/10273 operations (88%), 260440064/280875113 bytes downloaded (92%), overall progress 90%</span><br><span class="line">08-18 19:26:46.100  1471  1471 I update_engine: [INFO:delta_performer.cc(385)] Opening /dev/block/bootdevice/by-name/vendor_boot_b partition without O_DSYNC</span><br><span class="line">08-18 19:26:46.106  1471  1471 I update_engine: [INFO:delta_performer.cc(128)] Caching writes.</span><br><span class="line">08-18 19:26:46.108  1471  1471 I update_engine: [INFO:delta_performer.cc(397)] Applying 51 operations to partition &quot;vendor_boot&quot;</span><br><span class="line">08-18 19:26:46.150  1471  1471 E update_engine: [ERROR:delta_performer.cc(431)] Unable to open ECC source partition vendor_boot on slot A, file /dev/block/bootdevice/by-name/vendor_boot_a: Success (0)</span><br><span class="line">08-18 19:26:46.155  1471  1471 E update_engine: [ERROR:delta_performer.cc(1158)] The hash of the source data on disk for this operation doesn&#x27;t match the expected value. This could mean that the delta update payload was targeted for another version, or that the source partition was modified after it was installed, for example, by mounting a filesystem.</span><br><span class="line">08-18 19:26:46.157  1471  1471 E update_engine: [ERROR:delta_performer.cc(1163)] Expected:   sha256|hex = 84CBC3930817F59F08D6BAE4E64F40452AEEE007C8B2D74439358BD56446DF6C</span><br><span class="line">08-18 19:26:46.159  1471  1471 E update_engine: [ERROR:delta_performer.cc(1166)] Calculated: sha256|hex = CE99046C8D163FBD1490314FA7582269045D8A1B2B2DDF14EC6B3DF8961D5176</span><br><span class="line">08-18 19:26:46.161  1471  1471 E update_engine: [ERROR:delta_performer.cc(1177)] Operation source (offset:size) in blocks: 0:741,24575:1</span><br><span class="line">08-18 19:26:46.164  1471  1471 E update_engine: [ERROR:delta_performer.cc(1498)] source_fd != nullptr failed.</span><br><span class="line">08-18 19:26:46.166  1471  1471 E update_engine: [ERROR:delta_performer.cc(297)] Failed to perform BROTLI_BSDIFF operation 9648, which is the operation 0 in partition &quot;vendor_boot&quot;</span><br><span class="line">08-18 19:26:46.168  1471  1471 E update_engine: [ERROR:download_action.cc(336)] Error ErrorCode::kDownloadStateInitializationError (20) in DeltaPerformer&#x27;s Write method when processing the received payload -- Terminating processing</span><br><span class="line">08-18 19:26:46.172  1471  1471 I update_engine: [INFO:delta_performer.cc(314)] Discarding 287 unused downloaded bytes</span><br><span class="line">08-18 19:26:46.174  1471  1471 I update_engine: [INFO:multi_range_http_fetcher.cc(177)] Received transfer terminated.</span><br><span class="line">08-18 19:26:46.176  1471  1471 I update_engine: [INFO:multi_range_http_fetcher.cc(129)] TransferEnded w/ code 200</span><br><span class="line">08-18 19:26:46.177  1471  1471 I update_engine: [INFO:multi_range_http_fetcher.cc(131)] Terminating.</span><br><span class="line">08-18 19:26:46.236  1471  1471 I update_engine: [INFO:action_processor.cc(116)] ActionProcessor: finished DownloadAction with code ErrorCode::kDownloadStateInitializationError</span><br><span class="line">08-18 19:26:46.240  1471  1471 I update_engine: [INFO:action_processor.cc(121)] ActionProcessor: Aborting processing due to failure.</span><br><span class="line">08-18 19:26:46.242  1471  1471 I update_engine: [INFO:update_attempter_android.cc(522)] Processing Done.</span><br><span class="line">08-18 19:26:46.245  1471  1471 I update_engine: [INFO:delta_performer.cc(1997)] Resetting recorded hash for prepared partitions.</span><br><span class="line">08-18 19:26:46.248  1471  1471 I update_engine: [INFO:update_attempter_android.cc(546)] Resetting update progress.</span><br><span class="line">08-18 19:26:46.250  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(263)] Destroying [odm_b, product_b, system_b, vendor_b] from device mapper</span><br><span class="line">08-18 19:26:46.278  1471  1471 I update_engine: [libfs_mgr]Unmapped logical partition odm_b</span><br><span class="line">08-18 19:26:46.354  1471  1471 I update_engine: Successfully unmapped snapshot odm_b</span><br><span class="line">08-18 19:26:46.359  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(249)] Successfully unmapped odm_b from device mapper.</span><br><span class="line">08-18 19:26:46.386  1471  1471 I update_engine: [libfs_mgr]Unmapped logical partition product_b</span><br><span class="line">08-18 19:26:46.471  1471  1471 I update_engine: Successfully unmapped snapshot product_b</span><br><span class="line">08-18 19:26:46.477  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(249)] Successfully unmapped product_b from device mapper.</span><br><span class="line">08-18 19:26:46.506  1471  1471 I update_engine: [libfs_mgr]Unmapped logical partition system_b</span><br><span class="line">08-18 19:26:46.587  1471  1471 I update_engine: Successfully unmapped snapshot system_b</span><br><span class="line">08-18 19:26:46.592  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(249)] Successfully unmapped system_b from device mapper.</span><br><span class="line">08-18 19:26:46.689  1471  1471 I update_engine: [libfs_mgr]Unmapped logical partition vendor_b</span><br><span class="line">08-18 19:26:46.742  1471  1471 I update_engine: Successfully unmapped snapshot vendor_b</span><br><span class="line">08-18 19:26:46.746  1471  1471 I update_engine: [INFO:dynamic_partition_control_android.cc(249)] Successfully unmapped vendor_b from device mapper.</span><br><span class="line">08-18 19:26:46.759  1471  1471 I update_engine: [INFO:metrics_reporter_android.cc(131)] Current update attempt downloads 262 bytes data</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="r-上virtual-ab的适配"><a href="#r-上virtual-ab的适配" class="headerlink" title="r 上virtual ab的适配"></a>r 上virtual ab的适配</h1><h2 id="recovery上的修改"><a href="#recovery上的修改" class="headerlink" title="recovery上的修改"></a>recovery上的修改</h2><h3 id="升级过程调试"><a href="#升级过程调试" class="headerlink" title="升级过程调试"></a>升级过程调试</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">adb push otacerts.zip /system/etc/security/</span><br><span class="line">update_engine_sideload  --payload=file:///tmp/update.zip  --offset=1418 --headers=&quot;\</span><br><span class="line">FILE_HASH=fhPRX5CaUAmedhRy1E8Ee9lAib+pb9uMd1cb+fzx638=</span><br><span class="line">FILE_SIZE=181915047</span><br><span class="line">METADATA_HASH=tUuwjykp1KDc2C1ME+YOZn9tOnHhDzP2ukNFqKVf/tQ=</span><br><span class="line">METADATA_SIZE=607150</span><br><span class="line">&quot;</span><br><span class="line">update_engine_sideload  --payload=file:///tmp/update.zip  --offset=1324 --headers=&quot;\</span><br><span class="line">FILE_HASH=76gLVcAOp24qvgZC0iigNmi+27SwESfR003JZSzJ5C8=</span><br><span class="line">FILE_SIZE=3650338089</span><br><span class="line">METADATA_HASH=h83AZLcrxwdYTK2kr/fajBovPRqOGcmBu1gy6IqEtUI=</span><br><span class="line">METADATA_SIZE=210289</span><br><span class="line">&quot;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>算offset的方法:</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">with</span> zipfile.ZipFile(<span class="string">&#x27;/home/mi/Downloads/miui-blockota-venus-20.9.24.root-20.9.27.root-f8ff8484a9-11.0.zip&#x27;</span>) <span class="keyword">as</span> input_zip:</span><br><span class="line">  a = input_zip.getinfo(<span class="string">&#x27;payload_properties.txt&#x27;</span>)</span><br><span class="line">  c = input_zip.getinfo(<span class="string">&#x27;payload.bin&#x27;</span>)</span><br><span class="line">  b = a.header_offset - c.file_size</span><br><span class="line">  <span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">update_engine_client \</span><br><span class="line">--payload=file:///data/ota_package/payload.bin \</span><br><span class="line">--update \</span><br><span class="line">--headers=&quot;\</span><br><span class="line">FILE_HASH=micJIkMGwvRYI01GT3ESWtE3O6drypDdWHrAj7mbHJE=</span><br><span class="line">FILE_SIZE=171868736</span><br><span class="line">METADATA_HASH=AnZQNNsMgBsqA0z8asH14haURnuJ35GVvc8HqY2gRbQ=</span><br><span class="line">METADATA_SIZE=1014574</span><br><span class="line">&quot;</span><br><span class="line"></span><br><span class="line">update_engine_client \</span><br><span class="line">--payload=file:///data/ota_package/payload.bin \</span><br><span class="line">--update \</span><br><span class="line">--headers=&quot;\</span><br><span class="line">FILE_HASH=GmmYrTs4n1u+a52W7cHE0MQ59sw/qrPAvsuR7JgB2B0=</span><br><span class="line">FILE_SIZE=3618079575</span><br><span class="line">METADATA_HASH=HpGq2D4TNzkkdxlbfoMzbCvKKht4LRDD5kqlHAnbOxg=</span><br><span class="line">METADATA_SIZE=210965</span><br><span class="line">&quot;</span><br></pre></td></tr></table></figure>



<h2 id="估算"><a href="#估算" class="headerlink" title="估算"></a>估算</h2><p>data report:</p>
<p>fullOTA:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"> # </span><span class="language-bash">target_file size</span></span><br><span class="line"><span class="meta prompt_">[$</span><span class="language-bash">] -&gt; ll signed_venus_global-target_files-20.10.16-11.0.zip</span></span><br><span class="line">-rw-rw-r-- 1 mi mi 8331428868 10月 16 12:10 signed_venus_global-target_files-20.10.16-11.0.zip</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">images <span class="keyword">in</span> target_file</span></span><br><span class="line"><span class="meta prompt_">[$</span><span class="language-bash">] -&gt; ll signed_venus_global-target_files-20.10.16-11.0/IMAGES</span></span><br><span class="line">-rw-rw-r--  1 mi mi  100663296 1月   1  2009 boot-gki.img</span><br><span class="line">-rw-rw-r--  1 mi mi  201326592 1月   1  2009 boot.img</span><br><span class="line">-rw-rw-r--  1 mi mi    8388608 1月   1  2009 dtbo.img</span><br><span class="line">-rw-rw-r--  1 mi mi    1065072 1月   1  2009 odm.img</span><br><span class="line">-rw-rw-r--  1 mi mi        677 1月   1  2009 odm.map</span><br><span class="line">-rw-rw-r--  1 mi mi 1048531236 1月   1  2009 product.img</span><br><span class="line">-rw-rw-r--  1 mi mi      43776 1月   1  2009 product.map</span><br><span class="line">-rw-rw-r--  1 mi mi       5080 1月   1  2009 super_empty.img</span><br><span class="line">-rw-rw-r--  1 mi mi  403837100 1月   1  2009 system_ext.img</span><br><span class="line">-rw-rw-r--  1 mi mi      78781 1月   1  2009 system_ext.map</span><br><span class="line">-rw-rw-r--  1 mi mi 2908402304 1月   1  2009 system.img</span><br><span class="line">-rw-rw-r--  1 mi mi     302171 1月   1  2009 system.map</span><br><span class="line">-rw-rw-r--  1 mi mi    2695444 1月   1  2009 userdata.img</span><br><span class="line">-rw-rw-r--  1 mi mi       4096 1月   1  2009 vbmeta.img</span><br><span class="line">-rw-rw-r--  1 mi mi       4096 1月   1  2009 vbmeta_system.img</span><br><span class="line">-rw-rw-r--  1 mi mi  100663296 1月   1  2009 vendor_boot.img</span><br><span class="line">-rw-rw-r--  1 mi mi 2033811940 1月   1  2009 vendor.img</span><br><span class="line">-rw-rw-r--  1 mi mi     303801 1月   1  2009 vendor.map</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">full ota size</span></span><br><span class="line"><span class="meta prompt_">[$</span><span class="language-bash">] -&gt; ll miui_VENUSGlobal_20.10.16_aefb58d7af_11.0.zip</span>     </span><br><span class="line">-rw-rw-r-- 1 mi mi 2925387044 10月 16 12:11 miui_VENUSGlobal_20.10.16_aefb58d7af_11.0.zip</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">estimate result</span></span><br><span class="line">out/host/linux-x86/bin/estimate_cow_from_nonab_ota -ota_tf /home/mi/Downloads/signed_venus_global-target_files-20.10.16-11.0</span><br><span class="line">Unsparsing IMAGES/vendor.img ...</span><br><span class="line">Analyzing vendor ...</span><br><span class="line">Unsparsing IMAGES/product.img ...</span><br><span class="line">Analyzing product ...</span><br><span class="line">Unsparsing IMAGES/odm.img ...</span><br><span class="line">Analyzing odm ...</span><br><span class="line">Unsparsing IMAGES/system_ext.img ...</span><br><span class="line">Analyzing system_ext ...</span><br><span class="line">Unsparsing IMAGES/system.img ...</span><br><span class="line">Analyzing system ...</span><br><span class="line">Estimated COW size: 3718300499 (3546MiB)</span><br></pre></td></tr></table></figure>

<p>incOTA:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">src target_file</span></span><br><span class="line"><span class="meta prompt_">[$</span><span class="language-bash">] -&gt; ll signed_venus_global-target_files-20.9.24-11.0.zip</span></span><br><span class="line">-rw-rw-r-- 1 mi mi 7912365948 10月 16 12:09 signed_venus_global-target_files-20.9.24-11.0.zip</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">images <span class="keyword">in</span> src target_file</span></span><br><span class="line"><span class="meta prompt_">[$</span><span class="language-bash">] -&gt; ll signed_venus_global-target_files-20.9.24-11.0/IMAGES</span></span><br><span class="line">-rw-rw-r--  1 mi mi  201326592 1月   1  2009 boot.img</span><br><span class="line">-rw-rw-r--  1 mi mi    8388608 1月   1  2009 dtbo.img</span><br><span class="line">-rw-rw-r--  1 mi mi    1020016 1月   1  2009 odm.img</span><br><span class="line">-rw-rw-r--  1 mi mi        381 1月   1  2009 odm.map</span><br><span class="line">-rw-rw-r--  1 mi mi 1044939068 1月   1  2009 product.img</span><br><span class="line">-rw-rw-r--  1 mi mi      43382 1月   1  2009 product.map</span><br><span class="line">-rw-rw-r--  1 mi mi       5080 1月   1  2009 super_empty.img</span><br><span class="line">-rw-rw-r--  1 mi mi  371994820 1月   1  2009 system_ext.img</span><br><span class="line">-rw-rw-r--  1 mi mi      79300 1月   1  2009 system_ext.map</span><br><span class="line">-rw-rw-r--  1 mi mi 2706129500 1月   1  2009 system.img</span><br><span class="line">-rw-rw-r--  1 mi mi     296543 1月   1  2009 system.map</span><br><span class="line">-rw-rw-r--  1 mi mi    2695444 1月   1  2009 userdata.img</span><br><span class="line">-rw-rw-r--  1 mi mi       8192 1月   1  2009 vbmeta.img</span><br><span class="line">-rw-rw-r--  1 mi mi       4096 1月   1  2009 vbmeta_system.img</span><br><span class="line">-rw-rw-r--  1 mi mi  100663296 1月   1  2009 vendor_boot.img</span><br><span class="line">-rw-rw-r--  1 mi mi 1891361204 1月   1  2009 vendor.img</span><br><span class="line">-rw-rw-r--  1 mi mi     279594 1月   1  2009 vendor.map</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"> # </span><span class="language-bash">target_file size</span></span><br><span class="line"><span class="meta prompt_">[$</span><span class="language-bash">] -&gt; ll signed_venus_global-target_files-20.10.16-11.0.zip</span></span><br><span class="line">-rw-rw-r-- 1 mi mi 8331428868 10月 16 12:10 signed_venus_global-target_files-20.10.16-11.0.zip</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">images <span class="keyword">in</span> target_file</span></span><br><span class="line"><span class="meta prompt_">[$</span><span class="language-bash">] -&gt; ll signed_venus_global-target_files-20.10.16-11.0/IMAGES</span></span><br><span class="line">-rw-rw-r--  1 mi mi  100663296 1月   1  2009 boot-gki.img</span><br><span class="line">-rw-rw-r--  1 mi mi  201326592 1月   1  2009 boot.img</span><br><span class="line">-rw-rw-r--  1 mi mi    8388608 1月   1  2009 dtbo.img</span><br><span class="line">-rw-rw-r--  1 mi mi    1065072 1月   1  2009 odm.img</span><br><span class="line">-rw-rw-r--  1 mi mi        677 1月   1  2009 odm.map</span><br><span class="line">-rw-rw-r--  1 mi mi 1048531236 1月   1  2009 product.img</span><br><span class="line">-rw-rw-r--  1 mi mi      43776 1月   1  2009 product.map</span><br><span class="line">-rw-rw-r--  1 mi mi       5080 1月   1  2009 super_empty.img</span><br><span class="line">-rw-rw-r--  1 mi mi  403837100 1月   1  2009 system_ext.img</span><br><span class="line">-rw-rw-r--  1 mi mi      78781 1月   1  2009 system_ext.map</span><br><span class="line">-rw-rw-r--  1 mi mi 2908402304 1月   1  2009 system.img</span><br><span class="line">-rw-rw-r--  1 mi mi     302171 1月   1  2009 system.map</span><br><span class="line">-rw-rw-r--  1 mi mi    2695444 1月   1  2009 userdata.img</span><br><span class="line">-rw-rw-r--  1 mi mi       4096 1月   1  2009 vbmeta.img</span><br><span class="line">-rw-rw-r--  1 mi mi       4096 1月   1  2009 vbmeta_system.img</span><br><span class="line">-rw-rw-r--  1 mi mi  100663296 1月   1  2009 vendor_boot.img</span><br><span class="line">-rw-rw-r--  1 mi mi 2033811940 1月   1  2009 vendor.img</span><br><span class="line">-rw-rw-r--  1 mi mi     303801 1月   1  2009 vendor.map</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">inc ota size</span></span><br><span class="line"><span class="meta prompt_">[$</span><span class="language-bash">] -&gt; ll miui-blockota-venus_global-20.9.24-20.10.16-958988d114-11.0.zip</span></span><br><span class="line">-rw-rw-r-- 1 mi mi 418387975 10月 16 12:05 miui-blockota-venus_global-20.9.24-20.10.16-958988d114-11.0.zip</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">estimate result</span></span><br><span class="line">out/host/linux-x86/bin/estimate_cow_from_nonab_ota -source_tf ~/Downloads/signed_venus_global-target_files-20.9.24-11.0/ -ota_tf /home/mi/Downloads/signed_venus_global-target_files-20.10.16-11.0</span><br><span class="line"></span><br><span class="line">Unsparsing IMAGES/vendor.img ...</span><br><span class="line">Unsparsing IMAGES/vendor.img ...</span><br><span class="line">Hashing blocks for vendor...</span><br><span class="line">Analyzing vendor ...</span><br><span class="line">Unsparsing IMAGES/product.img ...</span><br><span class="line">Unsparsing IMAGES/product.img ...</span><br><span class="line">Hashing blocks for product...</span><br><span class="line">Analyzing product ...</span><br><span class="line">Unsparsing IMAGES/odm.img ...</span><br><span class="line">Unsparsing IMAGES/odm.img ...</span><br><span class="line">Hashing blocks for odm...</span><br><span class="line">Analyzing odm ...</span><br><span class="line">Unsparsing IMAGES/system_ext.img ...</span><br><span class="line">Unsparsing IMAGES/system_ext.img ...</span><br><span class="line">Hashing blocks for system_ext...</span><br><span class="line">Analyzing system_ext ...</span><br><span class="line">Unsparsing IMAGES/system.img ...</span><br><span class="line">Unsparsing IMAGES/system.img ...</span><br><span class="line">Hashing blocks for system...</span><br><span class="line">Analyzing system ...</span><br><span class="line">Estimated COW size: 1509347450 (1439MiB)</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Android/" rel="tag"># Android</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2019/10/12/OTA%E7%9B%B8%E5%85%B3/keymaster%E8%A7%A3%E5%AF%86%E9%97%AE%E9%A2%98/" rel="prev" title="设备bootloader上锁状态下1217无法工作问题分析1">
      <i class="fa fa-chevron-left"></i> 设备bootloader上锁状态下1217无法工作问题分析1
    </a></div>
      <div class="post-nav-item">
    <a href="/2019/11/12/OTA%E7%9B%B8%E5%85%B3/Q%E5%8A%A8%E6%80%81%E5%88%86%E5%8C%BA%E8%B0%83%E7%A0%94/" rel="next" title="Q动态分区调研">
      Q动态分区调研 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#AB%E8%B0%83%E8%AF%95%E7%AC%94%E8%AE%B0"><span class="nav-number">1.</span> <span class="nav-text">AB调试笔记</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9B%B8%E5%85%B3%E6%96%87%E6%A1%A3"><span class="nav-number">1.1.</span> <span class="nav-text">相关文档</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3"><span class="nav-number">1.1.1.</span> <span class="nav-text">官方文档</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E6%96%B9%E6%96%87%E6%A1%A3"><span class="nav-number">1.1.2.</span> <span class="nav-text">第三方文档</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%8B%E5%89%8D%E7%9A%84%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3"><span class="nav-number">1.1.3.</span> <span class="nav-text">之前的项目文档</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E7%9B%B8%E5%85%B3"><span class="nav-number">1.2.</span> <span class="nav-text">配置相关</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E7%BC%96%E8%AF%91%E5%8F%98%E9%87%8F"><span class="nav-number">1.2.1.</span> <span class="nav-text">设置编译变量</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BF%85%E9%A1%BB%E9%92%88%E5%AF%B9-A-B-%E6%9B%B4%E6%96%B0%E7%9B%AE%E6%A0%87%E5%AE%9A%E4%B9%89%E7%9A%84%E5%8F%98%E9%87%8F"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">必须针对 A&#x2F;B 更新目标定义的变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A0%E6%B3%95%E9%92%88%E5%AF%B9-A-B-%E7%9B%AE%E6%A0%87%E5%AE%9A%E4%B9%89%E7%9A%84%E5%8F%98%E9%87%8F"><span class="nav-number">1.2.1.2.</span> <span class="nav-text">无法针对 A&#x2F;B 目标定义的变量:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%AF%E9%80%89-%E9%92%88%E5%AF%B9%E8%B0%83%E8%AF%95%E7%89%88%E6%9C%AC%E5%AE%9A%E4%B9%89%E7%9A%84%E5%8F%98%E9%87%8F"><span class="nav-number">1.2.1.3.</span> <span class="nav-text">可选 针对调试版本定义的变量</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8A%82%E9%80%89-%E9%9D%9EGMS%E7%89%88%E6%9C%AC%E9%9C%80%E8%A6%81%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="nav-number">1.2.2.</span> <span class="nav-text">(节选) 非GMS版本需要客户端</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A9%BA%E9%97%B4%E5%AF%B9%E6%AF%94"><span class="nav-number">1.3.</span> <span class="nav-text">空间对比</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%87%E7%BA%A7%E5%8C%85%E7%9B%B8%E5%85%B3"><span class="nav-number">1.4.</span> <span class="nav-text">升级包相关</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%80%E6%9C%BA%E6%9C%8D%E5%8A%A1%E5%90%AF%E5%8A%A8%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90"><span class="nav-number">1.5.</span> <span class="nav-text">开机服务启动代码分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AB-%E5%8D%87%E7%BA%A7%E8%BF%87%E7%A8%8B%E8%B0%83%E8%AF%95"><span class="nav-number">1.6.</span> <span class="nav-text">AB 升级过程调试</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0firmware%E5%88%86%E5%8C%BA"><span class="nav-number">1.6.1.</span> <span class="nav-text">添加firmware分区</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%9F%E7%94%9F%E6%89%93%E5%8C%85%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="nav-number">1.6.1.1.</span> <span class="nav-text">原生打包的方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#firmware%E7%9A%84%E7%9B%B8%E5%85%B3%E4%BF%AE%E6%94%B9"><span class="nav-number">1.6.1.2.</span> <span class="nav-text">firmware的相关修改</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%87%E7%BA%A7%E5%AE%8C%E6%88%90%E4%B8%8E%E5%88%87%E6%8D%A2slot"><span class="nav-number">1.6.2.</span> <span class="nav-text">升级完成与切换slot</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#recovery%E5%8D%87%E7%BA%A7X-slot"><span class="nav-number">1.7.</span> <span class="nav-text">recovery升级X_slot</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%AE%E9%87%8F%E5%8D%87%E7%BA%A7ota-log"><span class="nav-number">1.7.1.</span> <span class="nav-text">差量升级ota log</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#r-%E4%B8%8Avirtual-ab%E7%9A%84%E9%80%82%E9%85%8D"><span class="nav-number">2.</span> <span class="nav-text">r 上virtual ab的适配</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#recovery%E4%B8%8A%E7%9A%84%E4%BF%AE%E6%94%B9"><span class="nav-number">2.1.</span> <span class="nav-text">recovery上的修改</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%87%E7%BA%A7%E8%BF%87%E7%A8%8B%E8%B0%83%E8%AF%95"><span class="nav-number">2.1.1.</span> <span class="nav-text">升级过程调试</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BC%B0%E7%AE%97"><span class="nav-number">2.2.</span> <span class="nav-text">估算</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">liguang.zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">147</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">90</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">102</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="sidebar-button motion-element"><i class="fa fa-comment"></i>
    Chat
  </a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">liguang.zhang</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : 'Iv1.b2d7d95e69f1bcd6',
      clientSecret: '7cfd4d9a0c01f1f4399ddfb410db655e9ef7e3b5',
      repo        : 'liguangzhang.github.io',
      owner       : 'LiguangZhang',
      admin       : ['LiguangZhang'],
      id          : 'cfc5033d818d59552096e48a786a6b57',
        language: 'zh-CN',
      distractionFreeMode: false
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
